<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>HuiHut</title>
  
  <subtitle>专业修电脑，副业补衣服</subtitle>
  <link href="//atom.xml" rel="self"/>
  
  <link href="https://blog.huihut.com/"/>
  <updated>2018-10-14T10:45:09.698Z</updated>
  <id>https://blog.huihut.com/</id>
  
  <author>
    <name>修电脑的裁缝酱</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>技嘉Z370 HD3P + i7-8700K + GTX1080 装黑苹果 High Sierra 10.13.6</title>
    <link href="https://blog.huihut.com/2018/10/13/GIGABYTE_Z370_HD3P_i7-8700K_GTX1080_Install_Hackintosh_HighSierra10.13.6/"/>
    <id>https://blog.huihut.com/2018/10/13/GIGABYTE_Z370_HD3P_i7-8700K_GTX1080_Install_Hackintosh_HighSierra10.13.6/</id>
    <published>2018-10-13T05:00:00.000Z</published>
    <updated>2018-10-14T10:45:09.698Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本博文记录了组装台式机装黑苹果 High Sierra 10.13.6 的经历。</p><p>原本想装 Mojave 10.14 的，可惜发现在 Mojave 下还没有 GTX1080 的驱动，所以只能退而求其次装 High Sierra 了。</p><p>装 High Sierra 的过程中，第一次使用 10.13.6(17G2112) 镜像遇到个问题（下文有描述），无法进入安装界面，因此后来使用 10.13.5(17F77) 镜像装好后在 AppStore 更新 10.13.6</p><a id="more"></a><p><img src="http://ojlsgreog.bkt.clouddn.com/Hackintosh-High-Sierra-10.13.6.jpeg" alt="Hackintosh-High-Sierra-10.13.6"></p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><ul><li>主板：技嘉 Z370 HD3P</li><li>CPU：Intel Core i7-8700K</li><li>核显：Intel UHD Graphics 630</li><li>独显：七彩虹 iGame GTX1080 Vulcan X 8G</li><li>内存：海盗船复仇者 DDR4 3200 8G*2</li><li>固态硬盘：三星 SSD 970 EVO 250GB（Windows）</li><li>机械硬盘：西数 WD10EZEX 7200PPM 64M 1T（EFI + MacOS + Storage）</li><li>板载音频：Realtek ALC1220</li><li>板载网卡：Intel I219V2 PCI Express Gigabit Ethernet</li><li>USB蓝牙：绿联 CSR8891 USB蓝牙 4.0</li></ul><h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><p>本博文使用的一些软件工具驱动，下文则不赘述。</p><ul><li><a href="https://mirrors.dtops.cc/iso/MacOS/daliansky_macos/" target="_blank" rel="noopener">带 Clover 镜像</a><ul><li>10.13.6(17G2112) 镜像：<a href="https://mirrors.dtops.cc/iso/MacOS/daliansky_macos/macOS%20High%20Sierra%2010.13.6%2817G2112%29%20Installer%20with%20Clover%204606.dmg" target="_blank" rel="noopener">macOS High Sierra 10.13.6(17G2112) Installer with Clover 4606.dmg</a></li><li>10.13.5(17F77)镜像：<a href="https://mirrors.dtops.cc/iso/MacOS/daliansky_macos/macOS%20High%20Sierra%2010.13.5%2817F77%29%20Installer%20with%20Clover%204512.dmg" target="_blank" rel="noopener">macOS High Sierra 10.13.5(17F77) Installer with Clover 4512.dmg</a></li></ul></li><li>EFI 分区<ul><li><a href="https://github.com/huihut/Hackintosh-Z370/tree/master/EFI" target="_blank" rel="noopener">huihut . Hackintosh-Z370/EFI</a></li></ul></li><li>工具<ul><li>U盘刻录工具 Etcher：<a href="https://etcher.io/" target="_blank" rel="noopener">官网</a> | <a href="https://pan.baidu.com/s/1EAarG7mLxhI0xwQEXerUEg" target="_blank" rel="noopener">百度网盘</a></li><li>Clover 配置工具 Clover Configurator：<a href="https://www.tonymacx86.com/resources/clover-configurator.335/" target="_blank" rel="noopener">官网</a> | <a href="https://pan.baidu.com/s/1adKnfyIT0MVwHGl_Lke_Fg" target="_blank" rel="noopener">百度网盘</a></li><li>内核注入工具 Kext Wizard：<a href="https://mac.softpedia.com/get/Utilities/Kext-Wizard.shtml" target="_blank" rel="noopener">网络</a> | <a href="https://pan.baidu.com/s/1bnsRR4s3FYmc6jCRiVYRew" target="_blank" rel="noopener">百度网盘</a></li><li>文本编辑器 BBEdit 12：<a href="https://www.barebones.com/products/bbedit/" target="_blank" rel="noopener">官网</a> | <a href="https://pan.baidu.com/s/1pWO_hFMcHIjzoFGSOdUgDQ" target="_blank" rel="noopener">百度网盘</a></li></ul></li><li>驱动<ul><li>驱动安装工具 MultiBeast 10.4.0 - High Sierra：<a href="https://www.tonymacx86.com/resources/multibeast-10-4-0-high-sierra.401/" target="_blank" rel="noopener">官网</a> | <a href="https://pan.baidu.com/s/1QBX514ELiqltAJ_EcHan0g" target="_blank" rel="noopener">百度网盘</a></li><li>Nvidia Web 驱动 387.10.10.10.40.105（适用于 10.13.6）：<a href="https://www.nvidia.com/download/driverResults.aspx/136062/en-us" target="_blank" rel="noopener">官网</a> | <a href="https://pan.baidu.com/s/1pgf06gmxiwpK1256_7QmcQ" target="_blank" rel="noopener">百度网盘</a></li><li>Nvidia Web 驱动 387.10.10.10.35.106（适用于 10.13.5）：<a href="https://www.nvidia.com/download/driverResults.aspx/134834/en-us" target="_blank" rel="noopener">官网</a> | <a href="https://pan.baidu.com/s/13ObVcKgRqr1XIvDv2d96Eg" target="_blank" rel="noopener">百度网盘</a></li></ul></li></ul><h2 id="刻录镜像"><a href="#刻录镜像" class="headerlink" title="刻录镜像"></a>刻录镜像</h2><p>准备一个8G以上的U盘，使用 Etcher 刻录上面下载的镜像（带有 Clover EFI 分区）：<code>macOS High Sierra 10.13.6(17G2112) Installer with Clover 4606.dmg</code></p><p><img src="http://ojlsgreog.bkt.clouddn.com/etcher-create-hackintosh.png" alt="etcher-create-hackintosh"></p><h2 id="设置-BIOS"><a href="#设置-BIOS" class="headerlink" title="设置 BIOS"></a>设置 BIOS</h2><blockquote><p>BIOS 版本已更新为 F7</p></blockquote><ul><li>Save &amp; Exit -&gt; Load Optimized Defaults : Yes</li><li>M.I.T. -&gt; Advanced Memory Settings -&gt; Extreme Memory Profile(X.M.P.) : Profile 1</li><li>BIOS -&gt; Fast Boot : Disabled</li><li>BIOS -&gt; CSM Support : Disabled</li><li>Peripherals -&gt; Super IO Configuration -&gt; Serial Port : Disabled</li><li>Peripherals -&gt; USB Configuration -&gt; XHCI Hand-off : Enabled</li><li>Chipset -&gt; Vt-d : Disabled</li></ul><p>保存 BIOS 配置</p><h2 id="引导出错"><a href="#引导出错" class="headerlink" title="引导出错"></a>引导出错</h2><p>重启进入刻录好的U盘，选择 <code>Boot macOS Install from Install macOS High Sierra</code></p><p><img src="http://ojlsgreog.bkt.clouddn.com/IMG_20181007_204929.jpg" alt="Clover"></p><p>唠叨模式滚代码的时候出错：please go to <a href="https://panic.apple.com" target="_blank" rel="noopener">https://panic.apple.com</a> to report this panic</p><p><img src="http://ojlsgreog.bkt.clouddn.com/IMG_20181007_211514.jpg" alt="please go to https://panic.apple.com to report this panic"></p><h2 id="重新刻录"><a href="#重新刻录" class="headerlink" title="重新刻录"></a>重新刻录</h2><p>上面的问题 Google 了一圈并未发现解决办法，因此重新刻录 <code>macOS High Sierra 10.13.5(17F77) Installer with Clover 4512.dmg</code>，先装 10.13.5(17F77) 。</p><h2 id="引导安装"><a href="#引导安装" class="headerlink" title="引导安装"></a>引导安装</h2><p>这次的 10.13.5(17F77)  成功进入安装界面了。</p><p>打开磁盘工具，格好一个系统盘，格式为 APFS 或者 Mac OS 扩展（日志式），大小因人而异，我留了 128G。</p><p>格好后安装系统到这个盘。</p><p>安装过程中第一次自动重启依然进入 U 盘 Clover，引导进入格出来的盘继续安装。</p><p>第二次自动重启也是进入 U 盘 Clover，引导进入格出来的盘，然后安装完毕进入系统。</p><h2 id="安装-Clover"><a href="#安装-Clover" class="headerlink" title="安装 Clover"></a>安装 Clover</h2><h3 id="Clover-选择"><a href="#Clover-选择" class="headerlink" title="Clover 选择"></a>Clover 选择</h3><p>进入系统后发现 1080 独显不能驱动、八代 CPU 不能识别，这个先不管，先装 Clover 到磁盘的 EFI 分区。</p><p>安装 Clover 有两种：</p><ul><li>使用原版 CLover：<a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">Clover EFI bootloader 官方下载</a></li><li>使用 U 盘 EFI 分区的 Clover</li></ul><p>由于 U 盘的 Clover 是已经试验过能引导的，所以我就用了 U 盘的。</p><h3 id="挂载-EFI-分区"><a href="#挂载-EFI-分区" class="headerlink" title="挂载 EFI 分区"></a>挂载 EFI 分区</h3><p>在终端上执行 <code>diskutil list</code>，找到两个 EFI 分区（磁盘的 EFI 和 U 盘的 EFI），如下的 <code>disk0 s1</code> 和 <code>disk3 s1</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">HuiMac:~ huihut$ diskutil list</span><br><span class="line">/dev/disk0 (internal, physical):</span><br><span class="line">   #:                       TYPE NAME                    SIZE       IDENTIFIER</span><br><span class="line">   0:      GUID_partition_scheme                        *1.0 TB     disk0</span><br><span class="line">   1:                        EFI EFI                     209.7 MB   disk0s1</span><br><span class="line">   2:                 Apple_APFS Container disk2         128.8 GB   disk0s2</span><br><span class="line">   3:       Microsoft Basic Data Document                85.9 GB    disk0s3</span><br><span class="line">   4:       Microsoft Basic Data Software                161.1 GB   disk0s4</span><br><span class="line">   5:       Microsoft Basic Data Data                    624.2 GB   disk0s5</span><br><span class="line"></span><br><span class="line">/dev/disk1 (internal):</span><br><span class="line">   #:                       TYPE NAME                    SIZE       IDENTIFIER</span><br><span class="line">   0:      GUID_partition_scheme                         250.1 GB   disk1</span><br><span class="line">   1:         Microsoft Reserved                         16.8 MB    disk1s1</span><br><span class="line">   2:       Microsoft Basic Data                         249.2 GB   disk1s2</span><br><span class="line">   3:           Windows Recovery                         847.2 MB   disk1s3</span><br><span class="line"></span><br><span class="line">/dev/disk2 (synthesized):</span><br><span class="line">   #:                       TYPE NAME                    SIZE       IDENTIFIER</span><br><span class="line">   0:      APFS Container Scheme -                      +128.8 GB   disk2</span><br><span class="line">                                 Physical Store disk0s2</span><br><span class="line">   1:                APFS Volume MacOS                   84.8 GB    disk2s1</span><br><span class="line">   2:                APFS Volume Preboot                 67.7 MB    disk2s2</span><br><span class="line">   3:                APFS Volume Recovery                1.0 GB     disk2s3</span><br><span class="line">   4:                APFS Volume VM                      20.5 KB    disk2s4</span><br><span class="line"></span><br><span class="line">/dev/disk3 (external, physical):</span><br><span class="line">   #:                       TYPE NAME                    SIZE       IDENTIFIER</span><br><span class="line">   0:      GUID_partition_scheme                        *31.0 GB    disk3</span><br><span class="line">   1:                        EFI EFI                     209.7 MB   disk3s1</span><br><span class="line">   2:                  Apple_HFS Install macOS High S... 5.7 GB     disk3s2</span><br><span class="line"></span><br><span class="line">HuiMac:~ huihut$</span><br></pre></td></tr></table></figure><p>分别挂载到不同名字的卷</p><p>挂载磁盘 EFI<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /Volumes/efidisk</span><br><span class="line">sudo mount -t msdos /dev/disk0s1 /Volumes/efidisk</span><br></pre></td></tr></table></figure></p><p>挂载 U 盘 EFI<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /Volumes/efiusb</span><br><span class="line">sudo mount -t msdos /dev/disk3s1 /Volumes/efiusb</span><br></pre></td></tr></table></figure></p><h3 id="复制-Clover"><a href="#复制-Clover" class="headerlink" title="复制 Clover"></a>复制 Clover</h3><p>然后把 U 盘的 <code>EFI/CLOVER</code> 这个文件夹复制到 磁盘的 <code>EFI</code> 下 </p><h2 id="安装驱动"><a href="#安装驱动" class="headerlink" title="安装驱动"></a>安装驱动</h2><p>使用 MultiBeast 安装驱动，使用 Nvidia WebDriver 安装显卡驱动（MultiBeast 的 WebDriver 不能驱动我的 1080）。</p><p><img src="http://ojlsgreog.bkt.clouddn.com/Jietu20181007-221705.jpg" alt="MultiBeast-config"></p><p>装好 Nvidia WebDriver 后 1080 能驱动，不过 i7-8700K 的八代 CPU 还是不能识别，先不管，在 AppStore 更新 10.13.6。</p><h2 id="更新后安装驱动"><a href="#更新后安装驱动" class="headerlink" title="更新后安装驱动"></a>更新后安装驱动</h2><p>更新完 10.13.6 发现许多驱动有问题：</p><ul><li>独显无法驱动</li><li>CPU无法识别</li><li>声卡无法驱动</li><li>USB3.0无法驱动</li></ul><h3 id="驱动独显"><a href="#驱动独显" class="headerlink" title="驱动独显"></a>驱动独显</h3><p>使用适用于 10.13.6 的 WebDriver-387.10.10.10.40.105.pkg，装好重启后就 OK 了</p><p><img src="http://ojlsgreog.bkt.clouddn.com/Hackintosh-gpu.jpg" alt=""></p><h3 id="修复-CPU-识别"><a href="#修复-CPU-识别" class="headerlink" title="修复 CPU 识别"></a>修复 CPU 识别</h3><blockquote><p>参见 <a href="https://osx.cx/8-dai-cpu-installed-black-apple.html" target="_blank" rel="noopener">八代处理器安装黑苹果 关于本机显示“未知”解决办法</a></p></blockquote><p>挂载磁盘 EFI 分区（操作如上），使用 Clover Configurator 打开 <code>/EFI/CLOVER/config.plist</code></p><p>在 CPU 页面的 Type 中填入 Unknown，保存。</p><p><img src="http://ojlsgreog.bkt.clouddn.com/Jietu20181007-232553.jpg" alt=""></p><p>使用文本编辑器（如 BBEdit）打开 <code>/System/Library/PrivateFrameworks/AppleSystemInfo.framework/Versions/A/Resources/zh_CN.lproj/AppleSystemInfo.strings</code> 文件</p><p>修改 <code>UnknownCPUKind</code> 的值为 <code>3.7 GHz Intel Core i7-8700K</code></p><p><img src="http://ojlsgreog.bkt.clouddn.com/Jietu20181007-233544.jpg" alt="3.7 GHz Intel Core i7-8700K"></p><p>保存重启即可。</p><p><img src="http://ojlsgreog.bkt.clouddn.com/Hackintosh-system-information.jpg" alt=""></p><h3 id="修复声卡驱动"><a href="#修复声卡驱动" class="headerlink" title="修复声卡驱动"></a>修复声卡驱动</h3><blockquote><p>参见 <a href="https://imac.hk/applealc-kext-use.html" target="_blank" rel="noopener">黑苹果AppleALC声卡驱动安装使用教程</a></p></blockquote><p>我使用 MultiBeast 安装的 ALC1220 驱动在 10.13.6 下不能驱动我的声卡，试过 MultiBeast 的其他驱动也不行，因此使用另一种方法修复。</p><p>在 <a href="https://github.com/acidanthera/AppleALC/releases" target="_blank" rel="noopener">acidanthera/AppleALC/releases</a> 下载最新的 AppleALC 的 RELEASE 版 <code>AppleALC.kext</code>，使用 Kext Wizard 注入这个内核，如下图</p><p><img src="http://ojlsgreog.bkt.clouddn.com/Jietu20181007-225717.jpg" alt="Kext Wizard AppleALC.kext"><br><img src="http://ojlsgreog.bkt.clouddn.com/Jietu20181007-225733.jpg" alt="Kext Wizard AppleALC.kext"></p><p>然后挂载磁盘 EFI 分区（操作如上），把 <code>AppleALC.kext</code> 放入磁盘 EFI 分区的 <code>EFI/CLOVER/kexts/Other/</code>目录中。</p><p>然后在 <a href="https://github.com/acidanthera/AppleALC/tree/master/Resources" target="_blank" rel="noopener">acidanthera/AppleALC/Resources</a> 找到你的声卡型号的文件夹，进入（如我的是 <code>ALC1220</code>）。</p><p><img src="http://ojlsgreog.bkt.clouddn.com/Jietu20181007-230207.jpg" alt="ALC1220"></p><p>我的声卡型号看到有 <code>layout1.xml</code>、<code>layout2.xml</code>、<code>layout5.xml</code>、<code>layout7.xml</code>、<code>layout11.xml</code>、<code>layout13.xml</code></p><p>然后在 1、2、5、7、11、13 中随便取一个数。</p><p>使用文本编辑器打开磁盘 EFI 分区的 <code>EFI/CLOVER/config.plist</code> 文件，搜索 <code>&lt;key&gt;Audio&lt;/key&gt;</code>，把它的 <code>integer</code> 改为刚刚取的那个数（如 <code>1</code>）。</p><p><img src="http://ojlsgreog.bkt.clouddn.com/Jietu20181007-231402.jpg" alt="Audio"></p><p>保存重启即可。</p><p><img src="http://ojlsgreog.bkt.clouddn.com/Hackintosh-audio.jpg" alt=""></p><h3 id="修复-USB3-0"><a href="#修复-USB3-0" class="headerlink" title="修复 USB3.0"></a>修复 USB3.0</h3><blockquote><p>参见 <a href="https://hackintosher.com/guides/hackintosh-high-sierra-10-13-6-update-guide/" target="_blank" rel="noopener">HACKINTOSH HIGH SIERRA 10.13.6 UPDATE GUIDE</a></p></blockquote><p>使用上文描述的操作挂载磁盘的 EFI 分区</p><p>使用 Clover Configurator 打开 <code>/EFI/CLOVER/config.plist</code></p><p>如下图，插入（若已存在则修改为）配置信息</p><ul><li>Name*: com.apple.driver.usb.AppleUSBXHCI</li><li>Find* [HEX]: 837D880F 0F83A704 0000</li><li>Replace* [HEX]: 837D880F 90909090 9090</li><li>Comment: USB 10.13.6+ by PMHeart</li><li>MatchOS: 10.13.x</li></ul><p><img src="http://ojlsgreog.bkt.clouddn.com/Jietu20181007-223654.jpg" alt="Clover Configurator USB3.0"></p><p>保存重启即可。</p><p><img src="http://ojlsgreog.bkt.clouddn.com/hackintosh-usb3.jpg" alt=""></p><h3 id="蓝牙免驱"><a href="#蓝牙免驱" class="headerlink" title="蓝牙免驱"></a>蓝牙免驱</h3><p><img src="http://ojlsgreog.bkt.clouddn.com/Hackintosh-bluetooth.jpg" alt=""></p><h3 id="iMessage、序列号问题"><a href="#iMessage、序列号问题" class="headerlink" title="iMessage、序列号问题"></a>iMessage、序列号问题</h3><blockquote><p>参见 <a href="http://www.ituring.com.cn/article/274156" target="_blank" rel="noopener">[Hackintosh]解决黑苹果无法使用Siri、iMessage等服务</a></p></blockquote><h2 id="更换Clover主题"><a href="#更换Clover主题" class="headerlink" title="更换Clover主题"></a>更换Clover主题</h2><p>Clover主题可以到官方仓库下载：</p><ul><li><a href="https://clover-wiki.zetam.org/theme-database" target="_blank" rel="noopener">Clover Theme Repository</a></li></ul><p>也可以使用其他的，比如我使用这个简洁风格的：</p><ul><li><a href="https://github.com/al3xtjames/clover-theme-minimal" target="_blank" rel="noopener">Clover Minimal - A clean theme for the Clover UEFI bootloader</a></li></ul><p><img src="https://camo.githubusercontent.com/df4adb0f442a1baf2ec59cf17f3442253619af6f/687474703a2f2f692e696d67626f782e636f6d2f346773734c6453492e706e67" alt="clover-theme-minimal"></p><p>只需下载下来，放到 <code>/EFI/CLOVER/themes</code> 文件夹下，然后使用 Clover Configurator 打开 <code>/EFI/CLOVER/config.plist</code> 更换到这个主题就好啦。</p><p><img src="http://ojlsgreog.bkt.clouddn.com/Jietu20181013-001702.jpg" alt="更换Clover主题"></p><p>另外这个显示启动盘的标签的 <code>Label</code> 建议勾上，这样才知道选择的是哪个盘，保存重启即可。</p><h2 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h2><ul><li><a href="https://www.tonymacx86.com/" target="_blank" rel="noopener">tonymacx86</a></li><li><a href="https://blog.daliansky.net/" target="_blank" rel="noopener">黑果小兵的部落阁</a></li><li><a href="https://imac.hk/" target="_blank" rel="noopener">黑苹果乐园</a></li><li><a href="https://www.tonymacx86.com/threads/success-gigabyte-z370-hd3p-i7-8700k-gigabyte-rx580-4gb-mojave-10-14-0.256221/" target="_blank" rel="noopener">[Success] Gigabyte Z370 HD3P - i7 8700K - Gigabyte RX580 4GB - Mojave 10.14.0</a></li><li><a href="https://9to5mac.com/2017/04/28/building-a-gtx-1080-ti-powered-hackintosh-installing-macos-sierra-step-by-step-video/" target="_blank" rel="noopener">Building a GTX 1080 Ti-powered Hackintosh: Installing macOS Sierra step-by-step [Video]</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;本博文记录了组装台式机装黑苹果 High Sierra 10.13.6 的经历。&lt;/p&gt;
&lt;p&gt;原本想装 Mojave 10.14 的，可惜发现在 Mojave 下还没有 GTX1080 的驱动，所以只能退而求其次装 High Sierra 了。&lt;/p&gt;
&lt;p&gt;装 High Sierra 的过程中，第一次使用 10.13.6(17G2112) 镜像遇到个问题（下文有描述），无法进入安装界面，因此后来使用 10.13.5(17F77) 镜像装好后在 AppStore 更新 10.13.6&lt;/p&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="Mac" scheme="https://blog.huihut.com/tags/Mac/"/>
    
  </entry>
  
  <entry>
    <title>pyparsing 无法卸载导致安装 matplotlib 出错</title>
    <link href="https://blog.huihut.com/2018/10/13/PyparsingFailsToUninstallCausingErrorInInstallingMatplotlib/"/>
    <id>https://blog.huihut.com/2018/10/13/PyparsingFailsToUninstallCausingErrorInInstallingMatplotlib/</id>
    <published>2018-10-13T03:02:00.000Z</published>
    <updated>2018-10-14T06:43:50.366Z</updated>
    
    <content type="html"><![CDATA[<h2 id="表现"><a href="#表现" class="headerlink" title="表现"></a>表现</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install matplotlib</span><br></pre></td></tr></table></figure><p>安装 matplotlib 时出现以下错误</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> Found existing installation: pyparsing 1.5.6</span><br><span class="line">Cannot uninstall &apos;pyparsing&apos;. It is a distutils installed project and thus we cannot accurately determine which files belong to it which would lead to only a partial uninstall.</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>安装 matplotlib 需要卸载我已安装的 1.5.6 版本的 pyparsing，再重新装新版本，但是无法卸载</p><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p>手动重装最新版 pyparsing</p><p>首先，去官网查看最新版是什么版本：<a href="https://pypi.org/project/pyparsing/" target="_blank" rel="noopener">https://pypi.org/project/pyparsing/</a></p><p>当前最新版是 <code>pyparsing 2.2.0</code>，所以执行如下重新安装最新版：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install -I pyparsing==2.2.0</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;表现&quot;&gt;&lt;a href=&quot;#表现&quot; class=&quot;headerlink&quot; title=&quot;表现&quot;&gt;&lt;/a&gt;表现&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo pip install matplotlib&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;安装 matplotlib 时出现以下错误&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt; Found existing installation: pyparsing 1.5.6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Cannot uninstall &amp;apos;pyparsing&amp;apos;. It is a distutils installed project and thus we cannot accurately determine which files belong to it which would lead to only a partial uninstall.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="Python" scheme="https://blog.huihut.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>python-dev 库缺失导致安装 matplotlib 出错</title>
    <link href="https://blog.huihut.com/2018/10/13/MissingPython-devCausesErrorInInstallingMatplotlib/"/>
    <id>https://blog.huihut.com/2018/10/13/MissingPython-devCausesErrorInInstallingMatplotlib/</id>
    <published>2018-10-13T03:00:00.000Z</published>
    <updated>2018-10-14T06:44:27.620Z</updated>
    
    <content type="html"><![CDATA[<h2 id="表现"><a href="#表现" class="headerlink" title="表现"></a>表现</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install matplotlib</span><br></pre></td></tr></table></figure><p>安装 matplotlib 时出现以下错误</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">Installing collected packages: subprocess32, cycler, backports.functools-lru-cache, pyparsing, kiwisolver, matplotlib</span><br><span class="line">  Running setup.py install for subprocess32 ... error</span><br><span class="line">    Complete output from command /usr/bin/python2 -u -c &quot;import setuptools, tokenize;__file__=&apos;/tmp/pip-install-azXKeu/subprocess32/setup.py&apos;;f=getattr(tokenize, &apos;open&apos;, open)(__file__);code=f.read().replace(&apos;\r\n&apos;, &apos;\n&apos;);f.close();exec(compile(code, __file__, &apos;exec&apos;))&quot; install --record /tmp/pip-record-5SM9_6/install-record.txt --single-version-externally-managed --compile:</span><br><span class="line">    /usr/lib64/python2.7/distutils/dist.py:267: UserWarning: Unknown distribution option: &apos;python_requires&apos;</span><br><span class="line">      warnings.warn(msg)</span><br><span class="line">    running install</span><br><span class="line">    running build</span><br><span class="line">    running build_py</span><br><span class="line">    creating build</span><br><span class="line">    creating build/lib.linux-x86_64-2.7</span><br><span class="line">    copying subprocess32.py -&gt; build/lib.linux-x86_64-2.7</span><br><span class="line">    running build_ext</span><br><span class="line">    running build_configure</span><br><span class="line">    checking for gcc... gcc</span><br><span class="line">    checking whether the C compiler works... yes</span><br><span class="line">    checking for C compiler default output file name... a.out</span><br><span class="line">    checking for suffix of executables...</span><br><span class="line">    checking whether we are cross compiling... no</span><br><span class="line">    checking for suffix of object files... o</span><br><span class="line">    checking whether we are using the GNU C compiler... yes</span><br><span class="line">    checking whether gcc accepts -g... yes</span><br><span class="line">    checking for gcc option to accept ISO C89... none needed</span><br><span class="line">    checking how to run the C preprocessor... gcc -E</span><br><span class="line">    checking for grep that handles long lines and -e... /bin/grep</span><br><span class="line">    checking for egrep... /bin/grep -E</span><br><span class="line">    checking for ANSI C header files... yes</span><br><span class="line">    checking for sys/types.h... yes</span><br><span class="line">    checking for sys/stat.h... yes</span><br><span class="line">    checking for stdlib.h... yes</span><br><span class="line">    checking for string.h... yes</span><br><span class="line">    checking for memory.h... yes</span><br><span class="line">    checking for strings.h... yes</span><br><span class="line">    checking for inttypes.h... yes</span><br><span class="line">    checking for stdint.h... yes</span><br><span class="line">    checking for unistd.h... yes</span><br><span class="line">    checking for unistd.h... (cached) yes</span><br><span class="line">    checking fcntl.h usability... yes</span><br><span class="line">    checking fcntl.h presence... yes</span><br><span class="line">    checking for fcntl.h... yes</span><br><span class="line">    checking signal.h usability... yes</span><br><span class="line">    checking signal.h presence... yes</span><br><span class="line">    checking for signal.h... yes</span><br><span class="line">    checking sys/cdefs.h usability... yes</span><br><span class="line">    checking sys/cdefs.h presence... yes</span><br><span class="line">    checking for sys/cdefs.h... yes</span><br><span class="line">    checking for sys/types.h... (cached) yes</span><br><span class="line">    checking for sys/stat.h... (cached) yes</span><br><span class="line">    checking sys/syscall.h usability... yes</span><br><span class="line">    checking sys/syscall.h presence... yes</span><br><span class="line">    checking for sys/syscall.h... yes</span><br><span class="line">    checking for dirent.h that defines DIR... yes</span><br><span class="line">    checking for library containing opendir... none required</span><br><span class="line">    checking for pipe2... yes</span><br><span class="line">    checking for setsid... yes</span><br><span class="line">    checking whether dirfd is declared... yes</span><br><span class="line">    configure: creating ./config.status</span><br><span class="line">    config.status: creating _posixsubprocess_config.h</span><br><span class="line">    building &apos;_posixsubprocess32&apos; extension</span><br><span class="line">    creating build/temp.linux-x86_64-2.7</span><br><span class="line">    gcc -pthread -fno-strict-aliasing -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -DNDEBUG -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/usr/include/python2.7 -c _posixsubprocess.c -o build/temp.linux-x86_64-2.7/_posixsubprocess.o</span><br><span class="line">    _posixsubprocess.c:16:20: fatal error: Python.h: No such file or directory</span><br><span class="line">     #include &quot;Python.h&quot;</span><br><span class="line">                        ^</span><br><span class="line">    compilation terminated.</span><br><span class="line">    error: command &apos;gcc&apos; failed with exit status 1</span><br></pre></td></tr></table></figure><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>无法找到 python 库，<code>#include &quot;Python.h&quot;</code> 出错</p><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><ul><li><p>使用 apt (Ubuntu, Debian…) 安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python-dev   # for python2.x installs</span><br><span class="line">sudo apt-get install python3-dev  # for python3.x installs</span><br></pre></td></tr></table></figure></li><li><p>使用 yum (CentOS, RHEL…) 安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install python-devel   # for python2.x installs</span><br><span class="line">sudo yum install python34-devel   # for python3.4 installs</span><br></pre></td></tr></table></figure></li><li><p>使用 dnf (Fedora…) 安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf install python2-devel  # for python2.x installs</span><br><span class="line">sudo dnf install python3-devel  # for python3.x installs</span><br></pre></td></tr></table></figure></li><li><p>使用 zypper (openSUSE…) 安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper in python-devel   # for python2.x installs</span><br><span class="line">sudo zypper in python3-devel  # for python3.x installs</span><br></pre></td></tr></table></figure></li><li><p>使用 apk (Alpine…) 安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apk add python2-dev  # for python2.x installs</span><br><span class="line">sudo apk add python3-dev  # for python3.x installs</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;表现&quot;&gt;&lt;a href=&quot;#表现&quot; class=&quot;headerlink&quot; title=&quot;表现&quot;&gt;&lt;/a&gt;表现&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo pip install matplotlib&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;安装 matplotlib 时出现以下错误&lt;/p&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="Python" scheme="https://blog.huihut.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>WinRT(C++/CX) UTF8类型转换为std::string和Platform::String^的Unicode字符串</title>
    <link href="https://blog.huihut.com/2018/08/23/UTF8ToStdStrAndUTF8ToManagedStr/"/>
    <id>https://blog.huihut.com/2018/08/23/UTF8ToStdStrAndUTF8ToManagedStr/</id>
    <published>2018-08-23T15:44:50.000Z</published>
    <updated>2018-08-23T15:45:08.000Z</updated>
    
    <content type="html"><![CDATA[<p>Gist 仓库地址：<a href="https://gist.github.com/huihut/8f75e2332e05673ff7e1248ad5e85339" target="_blank" rel="noopener">https://gist.github.com/huihut/8f75e2332e05673ff7e1248ad5e85339</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">UTF8_To_Std_Str</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> nwLen = MultiByteToWideChar(CP_UTF8, <span class="number">0</span>, str.c_str(), <span class="number">-1</span>, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">wchar_t</span>* pwBuf = <span class="keyword">new</span> <span class="keyword">wchar_t</span>[nwLen + <span class="number">1</span>];</span><br><span class="line"><span class="built_in">memset</span>(pwBuf, <span class="number">0</span>, nwLen * <span class="number">2</span> + <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">MultiByteToWideChar(CP_UTF8, <span class="number">0</span>, str.c_str(), str.length(), pwBuf, nwLen);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> nLen = WideCharToMultiByte(CP_ACP, <span class="number">0</span>, pwBuf, <span class="number">-1</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span>* pBuf = <span class="keyword">new</span> <span class="keyword">char</span>[nLen + <span class="number">1</span>];</span><br><span class="line"><span class="built_in">memset</span>(pBuf, <span class="number">0</span>, nLen + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">WideCharToMultiByte(CP_ACP, <span class="number">0</span>, pwBuf, nwLen, pBuf, nLen, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> retStr = pBuf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span>[] pBuf;</span><br><span class="line"><span class="keyword">delete</span>[] pwBuf;</span><br><span class="line"></span><br><span class="line">pBuf = <span class="literal">NULL</span>;</span><br><span class="line">pwBuf = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> retStr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Platform::String^ UTF8_To_Managed_Str(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; str)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> nwLen = MultiByteToWideChar(CP_UTF8, <span class="number">0</span>, str.c_str(), <span class="number">-1</span>, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">wchar_t</span>* pwBuf = <span class="keyword">new</span> <span class="keyword">wchar_t</span>[nwLen + <span class="number">1</span>];</span><br><span class="line"><span class="built_in">memset</span>(pwBuf, <span class="number">0</span>, nwLen * <span class="number">2</span> + <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">MultiByteToWideChar(CP_UTF8, <span class="number">0</span>, str.c_str(), str.length(), pwBuf, nwLen);</span><br><span class="line"></span><br><span class="line">Platform::String^ pStr = ref <span class="keyword">new</span> Platform::String(pwBuf);</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span>[] pwBuf;</span><br><span class="line">pwBuf = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> pStr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Gist 仓库地址：&lt;a href=&quot;https://gist.github.com/huihut/8f75e2332e05673ff7e1248ad5e85339&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://gist.github.co
      
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="C++" scheme="https://blog.huihut.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>WinRT(C++/CX) Platform::String^ 与 std::string 的类型转换</title>
    <link href="https://blog.huihut.com/2018/08/23/TypeConversionBetweenPlatformStringAndStdstring/"/>
    <id>https://blog.huihut.com/2018/08/23/TypeConversionBetweenPlatformStringAndStdstring/</id>
    <published>2018-08-23T15:43:00.000Z</published>
    <updated>2018-08-23T15:43:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>Gist 仓库地址：<a href="https://gist.github.com/huihut/aa90bd3a202090e25b9a4792c80e6920" target="_blank" rel="noopener">https://gist.github.com/huihut/aa90bd3a202090e25b9a4792c80e6920</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">Managed_Str_To_Std_Str</span><span class="params">(Platform::String^ ms)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="function">wstring <span class="title">w_str</span><span class="params">(ms-&gt;Begin())</span></span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">std</span>::<span class="built_in">string</span>(w_str.begin(), w_str.end());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Platform::String^ Std_Str_To_Managed_Str(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; input)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">std</span>::wstring w_str = <span class="built_in">std</span>::wstring(input.begin(), input.end());</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">wchar_t</span>* w_chars = w_str.c_str();</span><br><span class="line">    <span class="keyword">return</span> (ref <span class="keyword">new</span> Platform::String(w_chars));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Gist 仓库地址：&lt;a href=&quot;https://gist.github.com/huihut/aa90bd3a202090e25b9a4792c80e6920&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://gist.github.co
      
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="C++" scheme="https://blog.huihut.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>OpenCV使用CMake和MinGW-w64的编译安装</title>
    <link href="https://blog.huihut.com/2018/07/31/CompiledOpenCVWithMinGW64/"/>
    <id>https://blog.huihut.com/2018/07/31/CompiledOpenCVWithMinGW64/</id>
    <published>2018-07-31T14:19:45.000Z</published>
    <updated>2018-10-14T06:40:40.965Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前写过的一篇博文：<a href="https://blog.huihut.com/2017/12/03/CompiledOpenCVRunInQt/">OpenCV使用CMake和MinGW的编译安装及其在Qt配置运行</a> 是使用 32 位的 MinGW 在 Windows 下编译 OpenCV 生成 32 位的 dll。</p><p>而这篇博文是使用 64 位的 MinGW 编译 OpenCV 生成 64 位的 dll。</p><p>因为博主没有 64 位 qmake，所以没勾选 <code>WITH_QT</code></p><blockquote><p>2018年10月13日为 OpenCV-4.0.0-alpha 而修改，主要改了 “编译 OpenCV 常见错误”</p></blockquote><h2 id="编译好的-OpenCV（MinGW-版）："><a href="#编译好的-OpenCV（MinGW-版）：" class="headerlink" title="编译好的 OpenCV（MinGW 版）："></a>编译好的 OpenCV（MinGW 版）：</h2><p><a href="https://github.com/huihut/OpenCV-MinGW-Build" target="_blank" rel="noopener">Github . huihut/OpenCV-MinGW-Build</a></p><a id="more"></a><h2 id="软件环境"><a href="#软件环境" class="headerlink" title="软件环境"></a>软件环境</h2><ul><li>Windows-10-64bit</li><li><a href="http://sourceforge.net/projects/mingwbuilds/files/host-windows/releases/4.8.1/64-bit/threads-posix/seh/x64-4.8.1-release-posix-seh-rev5.7z/download" target="_blank" rel="noopener">MinGW-x64-4.8.1-release-posix-seh-rev5</a></li><li><a href="https://cmake.org/download/" target="_blank" rel="noopener">CMake-3.12.0</a></li><li><a href="https://opencv.org/releases.html" target="_blank" rel="noopener">OpenCV-3.4.1</a> | <a href="https://opencv.org/releases.html" target="_blank" rel="noopener">OpenCV-4.0.0-alpha</a>（适用）</li></ul><h2 id="安装-MinGW-w64-并配置环境变量"><a href="#安装-MinGW-w64-并配置环境变量" class="headerlink" title="安装 MinGW-w64 并配置环境变量"></a>安装 MinGW-w64 并配置环境变量</h2><p>下载安装：<a href="http://sourceforge.net/projects/mingwbuilds/files/host-windows/releases/4.8.1/64-bit/threads-posix/seh/x64-4.8.1-release-posix-seh-rev5.7z/download" target="_blank" rel="noopener">MinGW-x64-4.8.1-release-posix-seh-rev5</a></p><p>为系统（用户）变量 <code>Path</code> 添加 <code>E:\MinGW-w64\x64-4.8.1-release-posix-seh-rev5\mingw64\bin</code></p><h2 id="使用-CMake-生成-OpenCV-的-Makefile"><a href="#使用-CMake-生成-OpenCV-的-Makefile" class="headerlink" title="使用 CMake 生成 OpenCV 的 Makefile"></a>使用 CMake 生成 OpenCV 的 Makefile</h2><p>打开 cmake-gui，设置源码和生成路径：</p><ul><li>Where is the source code: <code>E:/opencv_341/opencv/sources</code></li><li>Where to build the binaries: <code>E:/opencv_341/opencv_mingw64_build</code></li></ul><p>点击 Configure，设置编译器</p><ul><li>Specify the generator for this project: <code>MinGW Makefiles</code></li><li>Specify native compilers</li><li>Next</li><li>Compilers C: <code>E:\MinGW-w64\x64-4.8.1-release-posix-seh-rev5\mingw64\bin\gcc.exe</code></li><li>Compilers C++: <code>E:\MinGW-w64\x64-4.8.1-release-posix-seh-rev5\mingw64\bin\g++.exe</code></li><li>Finish</li></ul><p>编译配置：</p><ul><li>勾选 <code>WITH_OPENGL</code></li><li>勾选 <code>ENABLE_CXX11</code></li><li>不勾选 <code>WITH_IPP</code></li><li>不勾选 <code>ENABLE_PRECOMPILED_HEADERS</code></li></ul><p>点击 Configure，Generate 生成 Makefile</p><p>博主的配置信息如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">General configuration for OpenCV 3.4.1 =====================================</span><br><span class="line">  Version control:               unknown</span><br><span class="line"></span><br><span class="line">  Platform:</span><br><span class="line">    Timestamp:                   2018-07-31T02:14:11Z</span><br><span class="line">    Host:                        Windows 10.0.17134 AMD64</span><br><span class="line">    CMake:                       3.12.0</span><br><span class="line">    CMake generator:             MinGW Makefiles</span><br><span class="line">    CMake build tool:            E:/MinGW-w64/x64-4.8.1-release-posix-seh-rev5/mingw64/bin/mingw32-make.exe</span><br><span class="line">    Configuration:               Release</span><br><span class="line"></span><br><span class="line">  CPU/HW features:</span><br><span class="line">    Baseline:                    SSE SSE2 SSE3</span><br><span class="line">      requested:                 SSE3</span><br><span class="line">    Dispatched code generation:  SSE4_1 SSE4_2 FP16 AVX AVX2</span><br><span class="line">      requested:                 SSE4_1 SSE4_2 AVX FP16 AVX2 AVX512_SKX</span><br><span class="line">      SSE4_1 (3 files):          + SSSE3 SSE4_1</span><br><span class="line">      SSE4_2 (1 files):          + SSSE3 SSE4_1 POPCNT SSE4_2</span><br><span class="line">      FP16 (2 files):            + SSSE3 SSE4_1 POPCNT SSE4_2 FP16 AVX</span><br><span class="line">      AVX (5 files):             + SSSE3 SSE4_1 POPCNT SSE4_2 AVX</span><br><span class="line">      AVX2 (9 files):            + SSSE3 SSE4_1 POPCNT SSE4_2 FP16 FMA3 AVX AVX2</span><br><span class="line"></span><br><span class="line">  C/C++:</span><br><span class="line">    Built as dynamic libs?:      YES</span><br><span class="line">    C++11:                       YES</span><br><span class="line">    C++ Compiler:                E:/MinGW-w64/x64-4.8.1-release-posix-seh-rev5/mingw64/bin/g++.exe  (ver 4.8.1)</span><br><span class="line">    C++ flags (Release):         -fsigned-char -W -Wall -Werror=return-type -Werror=non-virtual-dtor -Werror=address -Werror=sequence-point -Wformat -Werror=format-security -Wmissing-declarations -Wundef -Winit-self -Wpointer-arith -Wshadow -Wsign-promo -Wuninitialized -Winit-self -Wno-narrowing -Wno-delete-non-virtual-dtor -Wno-comment -fdiagnostics-show-option -Wno-long-long -fomit-frame-pointer -ffunction-sections -fdata-sections  -msse -msse2 -msse3 -fvisibility=hidden -fvisibility-inlines-hidden -O3 -DNDEBUG  -DNDEBUG</span><br><span class="line">    C++ flags (Debug):           -fsigned-char -W -Wall -Werror=return-type -Werror=non-virtual-dtor -Werror=address -Werror=sequence-point -Wformat -Werror=format-security -Wmissing-declarations -Wundef -Winit-self -Wpointer-arith -Wshadow -Wsign-promo -Wuninitialized -Winit-self -Wno-narrowing -Wno-delete-non-virtual-dtor -Wno-comment -fdiagnostics-show-option -Wno-long-long -fomit-frame-pointer -ffunction-sections -fdata-sections  -msse -msse2 -msse3 -fvisibility=hidden -fvisibility-inlines-hidden -g  -O0 -DDEBUG -D_DEBUG</span><br><span class="line">    C Compiler:                  E:/MinGW-w64/x64-4.8.1-release-posix-seh-rev5/mingw64/bin/gcc.exe</span><br><span class="line">    C flags (Release):           -fsigned-char -W -Wall -Werror=return-type -Werror=non-virtual-dtor -Werror=address -Werror=sequence-point -Wformat -Werror=format-security -Wmissing-declarations -Wmissing-prototypes -Wstrict-prototypes -Wundef -Winit-self -Wpointer-arith -Wshadow -Wuninitialized -Winit-self -Wno-narrowing -Wno-comment -fdiagnostics-show-option -Wno-long-long -fomit-frame-pointer -ffunction-sections -fdata-sections  -msse -msse2 -msse3 -fvisibility=hidden -O3 -DNDEBUG  -DNDEBUG</span><br><span class="line">    C flags (Debug):             -fsigned-char -W -Wall -Werror=return-type -Werror=non-virtual-dtor -Werror=address -Werror=sequence-point -Wformat -Werror=format-security -Wmissing-declarations -Wmissing-prototypes -Wstrict-prototypes -Wundef -Winit-self -Wpointer-arith -Wshadow -Wuninitialized -Winit-self -Wno-narrowing -Wno-comment -fdiagnostics-show-option -Wno-long-long -fomit-frame-pointer -ffunction-sections -fdata-sections  -msse -msse2 -msse3 -fvisibility=hidden -g  -O0 -DDEBUG -D_DEBUG</span><br><span class="line">    Linker flags (Release):      -Wl,--gc-sections  </span><br><span class="line">    Linker flags (Debug):        -Wl,--gc-sections  </span><br><span class="line">    ccache:                      NO</span><br><span class="line">    Precompiled headers:         NO</span><br><span class="line">    Extra dependencies:          opengl32 glu32</span><br><span class="line">    3rdparty dependencies:</span><br><span class="line"></span><br><span class="line">  OpenCV modules:</span><br><span class="line">    To be built:                 calib3d core dnn features2d flann highgui imgcodecs imgproc java_bindings_generator ml objdetect photo python_bindings_generator shape stitching superres ts video videoio videostab</span><br><span class="line">    Disabled:                    js world</span><br><span class="line">    Disabled by dependency:      -</span><br><span class="line">    Unavailable:                 cudaarithm cudabgsegm cudacodec cudafeatures2d cudafilters cudaimgproc cudalegacy cudaobjdetect cudaoptflow cudastereo cudawarping cudev java python2 python3 viz</span><br><span class="line">    Applications:                tests perf_tests apps</span><br><span class="line">    Documentation:               NO</span><br><span class="line">    Non-free algorithms:         NO</span><br><span class="line"></span><br><span class="line">  Windows RT support:            NO</span><br><span class="line"></span><br><span class="line">  GUI: </span><br><span class="line">    Win32 UI:                    YES</span><br><span class="line">    OpenGL support:              YES (opengl32 glu32)</span><br><span class="line">    VTK support:                 NO</span><br><span class="line"></span><br><span class="line">  Media I/O: </span><br><span class="line">    ZLib:                        build (ver 1.2.11)</span><br><span class="line">    JPEG:                        build (ver 90)</span><br><span class="line">    WEBP:                        build (ver encoder: 0x020e)</span><br><span class="line">    PNG:                         build (ver 1.6.34)</span><br><span class="line">    TIFF:                        build (ver 42 - 4.0.9)</span><br><span class="line">    JPEG 2000:                   build (ver 1.900.1)</span><br><span class="line">    OpenEXR:                     build (ver 1.7.1)</span><br><span class="line"></span><br><span class="line">  Video I/O:</span><br><span class="line">    Video for Windows:           YES</span><br><span class="line">    DC1394:                      NO</span><br><span class="line">    FFMPEG:                      YES (prebuilt binaries)</span><br><span class="line">      avcodec:                   YES (ver 57.107.100)</span><br><span class="line">      avformat:                  YES (ver 57.83.100)</span><br><span class="line">      avutil:                    YES (ver 55.78.100)</span><br><span class="line">      swscale:                   YES (ver 4.8.100)</span><br><span class="line">      avresample:                YES (ver 3.7.0)</span><br><span class="line">    GStreamer:                   NO</span><br><span class="line">    DirectShow:                  YES</span><br><span class="line"></span><br><span class="line">  Parallel framework:            none</span><br><span class="line"></span><br><span class="line">  Trace:                         YES (built-in)</span><br><span class="line"></span><br><span class="line">  Other third-party libraries:</span><br><span class="line">    Lapack:                      NO</span><br><span class="line">    Eigen:                       NO</span><br><span class="line">    Custom HAL:                  NO</span><br><span class="line">    Protobuf:                    build (3.5.1)</span><br><span class="line"></span><br><span class="line">  NVIDIA CUDA:                   NO</span><br><span class="line"></span><br><span class="line">  OpenCL:                        YES (no extra features)</span><br><span class="line">    Include path:                E:/opencv_341/opencv/sources/3rdparty/include/opencl/1.2</span><br><span class="line">    Link libraries:              Dynamic load</span><br><span class="line"></span><br><span class="line">  Python (for build):            E:/Python37-32/python.exe</span><br><span class="line"></span><br><span class="line">  Java:                          </span><br><span class="line">    ant:                         NO</span><br><span class="line">    JNI:                         C:/Program Files (x86)/Java/jdk1.8.0_181/include C:/Program Files (x86)/Java/jdk1.8.0_181/include/win32 C:/Program Files (x86)/Java/jdk1.8.0_181/include</span><br><span class="line">    Java wrappers:               NO</span><br><span class="line">    Java tests:                  NO</span><br><span class="line"></span><br><span class="line">  Matlab:                        NO</span><br><span class="line"></span><br><span class="line">  Install to:                    E:/opencv_341/opencv_mingw64_build/install</span><br><span class="line">-----------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Configuring done</span><br><span class="line">Generating done</span><br></pre></td></tr></table></figure><h2 id="编译-OpenCV"><a href="#编译-OpenCV" class="headerlink" title="编译 OpenCV"></a>编译 OpenCV</h2><p>打开终端进行编译：（<code>-j</code> 是使用 <code>8</code> 个线程进行编译，请根据你的计算机配置合理设置线程数）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">E:</span><br><span class="line">cd E:\opencv_341\opencv_mingw64_build</span><br><span class="line">mingw32-make -j 8</span><br><span class="line">mingw32-make install</span><br></pre></td></tr></table></figure><p>如果 <code>mingw32-make -j 8</code> 遇到错误，请看下面的  <strong>编译 OpenCV 常见错误</strong>，否则执行 <code>mingw32-make install</code>，完成安装。</p><h2 id="编译-OpenCV-常见错误"><a href="#编译-OpenCV-常见错误" class="headerlink" title="编译 OpenCV 常见错误"></a>编译 OpenCV 常见错误</h2><h3 id="1-MinGW-w64-的-aviriff-h-文件注释错误"><a href="#1-MinGW-w64-的-aviriff-h-文件注释错误" class="headerlink" title="1. MinGW-w64 的 aviriff.h 文件注释错误"></a>1. MinGW-w64 的 aviriff.h 文件注释错误</h3><h4 id="表现"><a href="#表现" class="headerlink" title="表现"></a>表现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[ 49%] Building CXX object modules/videoio/CMakeFiles/opencv_videoio.dir/src/cap_dshow.cpp.obj</span><br><span class="line">In file included from E:\opencv_341\opencv\sources\modules\videoio\src\cap_dshow.cpp:113:0:</span><br><span class="line">e:\mingw-w64\x64-4.8.1-release-posix-seh-rev5\mingw64\x86_64-w64-mingw32\include\aviriff.h:2:8: error: expected constructor, destructor, or type conversion before &apos;file&apos;</span><br><span class="line"> * This file is part of the mingw-w64 runtime package.</span><br><span class="line">        ^</span><br><span class="line">e:\mingw-w64\x64-4.8.1-release-posix-seh-rev5\mingw64\x86_64-w64-mingw32\include\aviriff.h:3:25: error: &apos;refer&apos; does not name a type</span><br><span class="line"> * No warranty is given; refer to the file DISCLAIMER within this package.</span><br><span class="line">                         ^</span><br><span class="line">In file included from e:\mingw-w64\x64-4.8.1-release-posix-seh-rev5\mingw64\x86_64-w64-mingw32\include\aviriff.h:19:0,</span><br><span class="line">                 from E:\opencv_341\opencv\sources\modules\videoio\src\cap_dshow.cpp:113:</span><br><span class="line">e:\mingw-w64\x64-4.8.1-release-posix-seh-rev5\mingw64\x86_64-w64-mingw32\include\pshpack2.h:7:21: error: expected declaration before end of line</span><br><span class="line"> #pragma pack(push,2)</span><br><span class="line">                     ^</span><br><span class="line">modules\videoio\CMakeFiles\opencv_videoio.dir\build.make:146: recipe for target &apos;modules/videoio/CMakeFiles/opencv_videoio.dir/src/cap_dshow.cpp.obj&apos; failed</span><br><span class="line">mingw32-make[2]: *** [modules/videoio/CMakeFiles/opencv_videoio.dir/src/cap_dshow.cpp.obj] Error 1</span><br><span class="line">CMakeFiles\Makefile2:3057: recipe for target &apos;modules/videoio/CMakeFiles/opencv_videoio.dir/all&apos; failed</span><br><span class="line">mingw32-make[1]: *** [modules/videoio/CMakeFiles/opencv_videoio.dir/all] Error 2</span><br><span class="line">Makefile:161: recipe for target &apos;all&apos; failed</span><br><span class="line">mingw32-make: *** [all] Error 2</span><br></pre></td></tr></table></figure><p><img src="http://ojlsgreog.bkt.clouddn.com/MinGW-w64_aviriff.h_file_annotation_error.png" alt="MinGW-w64_aviriff.h_file_annotation_error"></p><h4 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h4><p>打开<code>E:\MinGW-w64\x64-4.8.1-release-posix-seh-rev5\mingw64\x86_64-w64-mingw32\include\aviriff.h</code></p><p>发现第一行的多行注释少了个<code>/</code>符号，加上保存，如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* This file is part of the mingw-w64 runtime package.</span></span><br><span class="line"><span class="comment">* No warranty is given; refer to the file DISCLAIMER within this package.</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>然后重新 <code>Configure</code>-<code>Generate</code>-<code>mingw32-make</code> 就好了。</p><h3 id="2-cap-msmf-cpp-capture-code-错误【2018年10月13日修改，因编译-OpenCV-4-0-0-alpha-时遇到并解决】"><a href="#2-cap-msmf-cpp-capture-code-错误【2018年10月13日修改，因编译-OpenCV-4-0-0-alpha-时遇到并解决】" class="headerlink" title="2. cap_msmf.cpp capture code 错误【2018年10月13日修改，因编译 OpenCV-4.0.0-alpha 时遇到并解决】"></a>2. cap_msmf.cpp capture code 错误【2018年10月13日修改，因编译 OpenCV-4.0.0-alpha 时遇到并解决】</h3><h4 id="表现-1"><a href="#表现-1" class="headerlink" title="表现"></a>表现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\videoio\src\cap_msmf.cpp: In member function &apos;HRESULT &#123;anonymous&#125;::ComPtr&lt;T&gt;::As(&#123;anonymous&#125;::ComPtr&lt;U&gt;&amp;) const [with U = IMF2DBuffer; T = IMFMediaBuffer; HRESULT = long int]&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\videoio\src\cap_msmf.cpp:172:5: error: control reaches end of non-void function [-Werror=return-type]</span><br><span class="line">     &#125;</span><br><span class="line">     ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\videoio\src\cap_msmf.cpp: In member function &apos;T* &#123;anonymous&#125;::ComPtr&lt;T&gt;::operator-&gt;() const [with T = IMF2DBuffer]&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\videoio\src\cap_msmf.cpp:149:5: error: control reaches end of non-void function [-Werror=return-type]</span><br><span class="line">     &#125;</span><br><span class="line">     ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\videoio\src\cap_msmf.cpp: In member function &apos;T* &#123;anonymous&#125;::ComPtr&lt;T&gt;::operator-&gt;() const [with T = IMFMediaBuffer]&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\videoio\src\cap_msmf.cpp:149:5: error: control reaches end of non-void function [-Werror=return-type]</span><br><span class="line">     &#125;</span><br><span class="line">     ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\videoio\src\cap_msmf.cpp: In member function &apos;T* &#123;anonymous&#125;::ComPtr&lt;T&gt;::operator-&gt;() const [with T = IMFSinkWriter]&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\videoio\src\cap_msmf.cpp:149:5: error: control reaches end of non-void function [-Werror=return-type]</span><br><span class="line">     &#125;</span><br><span class="line">     ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\videoio\src\cap_msmf.cpp: In member function &apos;T* &#123;anonymous&#125;::ComPtr&lt;T&gt;::Get() const [with T = IMFMediaBuffer]&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\videoio\src\cap_msmf.cpp:158:5: error: control reaches end of non-void function [-Werror=return-type]</span><br><span class="line">     &#125;</span><br><span class="line">     ^</span><br><span class="line">cc1plus.exe: some warnings being treated as errors</span><br><span class="line">modules\videoio\CMakeFiles\opencv_videoio.dir\build.make:188: recipe for target &apos;modules/videoio/CMakeFiles/opencv_videoio.dir/src/cap_msmf.cpp.obj&apos; failed</span><br><span class="line">mingw32-make[2]: *** [modules/videoio/CMakeFiles/opencv_videoio.dir/src/cap_msmf.cpp.obj] Error 1</span><br><span class="line">CMakeFiles\Makefile2:2556: recipe for target &apos;modules/videoio/CMakeFiles/opencv_videoio.dir/all&apos; failed</span><br><span class="line">mingw32-make[1]: *** [modules/videoio/CMakeFiles/opencv_videoio.dir/all] Error 2</span><br><span class="line">mingw32-make[1]: *** Waiting for unfinished jobs....</span><br><span class="line">[ 58%] Linking CXX shared library ..\..\bin\libopencv_dnn400.dll</span><br><span class="line">[ 59%] Built target opencv_dnn</span><br><span class="line">Makefile:161: recipe for target &apos;all&apos; failed</span><br><span class="line">mingw32-make: *** [all] Error 2</span><br></pre></td></tr></table></figure><p><img src="http://ojlsgreog.bkt.clouddn.com/20180925220634.png" alt=""></p><h4 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h4><p>因为 MinGW 不能编译 OpenCV 的 cap_msmf 那部分代码，具体见我提的 Issue：<a href="https://github.com/opencv/opencv/issues/12642" target="_blank" rel="noopener">Failed to compile opencv-4.0.0-alpha using mingw-w64</a>。</p><h4 id="解决-1"><a href="#解决-1" class="headerlink" title="解决"></a>解决</h4><p>所以，在 cmake-gui 编译配置中：</p><ul><li>不勾选 <code>WITH_MSMF</code></li></ul><p>然后重新 <code>Configure</code>-<code>Generate</code>-<code>mingw32-make</code></p><h3 id="3-‘M-PI’-was-not-declared-in-this-scope-错误【2018年10月13日修改，因编译-OpenCV-4-0-0-alpha-时遇到并解决】"><a href="#3-‘M-PI’-was-not-declared-in-this-scope-错误【2018年10月13日修改，因编译-OpenCV-4-0-0-alpha-时遇到并解决】" class="headerlink" title="3. ‘M_PI’ was not declared in this scope 错误【2018年10月13日修改，因编译 OpenCV-4.0.0-alpha 时遇到并解决】"></a>3. ‘M_PI’ was not declared in this scope 错误【2018年10月13日修改，因编译 OpenCV-4.0.0-alpha 时遇到并解决】</h3><h4 id="表现-2"><a href="#表现-2" class="headerlink" title="表现"></a>表现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">[ 86%] Building CXX object modules/calib3d/CMakeFiles/opencv_calib3d.dir/src/chessboard.cpp.obj</span><br><span class="line">In file included from E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:7:0:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.hpp: In constructor &apos;cv::details::FastX::Parameters::Parameters()&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.hpp:35:36: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">                 resolution = float(M_PI*0.25);</span><br><span class="line">                                    ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp: At global scope:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:25:42: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line"> const float MAX_ANGLE = float(48.0/180.0*M_PI);          // max angle between line segments supposed to be straight</span><br><span class="line">                                          ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:26:48: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line"> const float MIN_COS_ANGLE = float(cos(35.0/180*M_PI));   // min cos angle between board edges</span><br><span class="line">                                                ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:29:35: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line"> const float RAD2DEG = float(180.0/M_PI);</span><br><span class="line">                                   ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp: In function &apos;int cv::details::testPointSymmetry(cv::Mat, cv::Point2f, float, float)&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:217:33: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">     for(double angle=0;angle &lt;= M_PI;angle+=M_PI*0.1)</span><br><span class="line">                                 ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp: In member function &apos;void cv::details::FastX::rotate(float, const cv::Mat&amp;, cv::Size, cv::Mat&amp;) const&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:287:110: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">         cv::Mat m = cv::getRotationMatrix2D(cv::Point2f(float(img.cols*0.5),float(img.rows*0.5)),float(angle/M_PI*180),1);</span><br><span class="line">                                                                                                              ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp: In member function &apos;std::vector&lt;std::vector&lt;float&gt; &gt; cv::details::FastX::calcAngles(const std::vector&lt;cv::Mat&gt;&amp;, std::vector&lt;cv::KeyPoint&gt;&amp;) const&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:393:30: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">     float resolution = float(M_PI/channels);</span><br><span class="line">                              ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp: In member function &apos;void cv::details::FastX::detectImpl(const cv::Mat&amp;, std::vector&lt;cv::Mat&gt;&amp;, std::vector&lt;cv::Mat&gt;&amp;, const cv::Mat&amp;) const&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:631:30: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">         int num = int(0.5001*M_PI/parameters.resolution);</span><br><span class="line">                              ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp: In member function &apos;void cv::details::Ellipse::draw(cv::InputOutputArray, const Scalar&amp;) const&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:721:43: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">     cv::ellipse(img,center,axes,360-angle/M_PI*180,0,360,color);</span><br><span class="line">                                           ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp: In static member function &apos;static float cv::details::Chessboard::Board::findMaxPoint(cv::flann::Index&amp;, const cv::Mat&amp;, const cv::details::Ellipse&amp;, float, float, cv::Point2f&amp;)&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:1541:17: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">         if(a1 &gt; M_PI*0.5)</span><br><span class="line">                 ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:1543:16: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">         if(a2&gt; M_PI*0.5)</span><br><span class="line">                ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp: In static member function &apos;static bool cv::details::Chessboard::Board::estimateSearchArea(const Point2f&amp;, const Point2f&amp;, const Point2f&amp;, float, cv::details::Ellipse&amp;, const Point2f*)&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:1787:28: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">         angle = float(2.0F*M_PI-angle);</span><br><span class="line">                            ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp: In member function &apos;void cv::details::Chessboard::findKeyPoints(const cv::Mat&amp;, std::vector&lt;cv::KeyPoint&gt;&amp;, std::vector&lt;cv::Mat&gt;&amp;, std::vector&lt;std::vector&lt;float&gt; &gt;&amp;, const cv::Mat&amp;) const&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:2793:29: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">     para.resolution = float(M_PI*0.25);   // this gives the best results taking interpolation into account</span><br><span class="line">                             ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp: In member function &apos;cv::Mat cv::details::Chessboard::buildData(const std::vector&lt;cv::KeyPoint&gt;&amp;) const&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:2844:30: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">         (*val++) = float(2.0*M_PI-iter-&gt;angle/180.0*M_PI);</span><br><span class="line">                              ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp: In member function &apos;std::vector&lt;cv::KeyPoint&gt; cv::details::Chessboard::getInitialPoints(cv::flann::Index&amp;, const cv::Mat&amp;, const cv::KeyPoint&amp;, float, float, float) const&apos;:</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:2874:25: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">         if(angle_temp &gt; M_PI*0.5)</span><br><span class="line">                         ^</span><br><span class="line">E:\opencv-4.0.0-alpha\opencv-4.0.0-alpha\modules\calib3d\src\chessboard.cpp:2879:29: error: &apos;M_PI&apos; was not declared in this scope</span><br><span class="line">             if(angle_temp &gt; M_PI*0.5)</span><br><span class="line">                             ^</span><br><span class="line">modules\calib3d\CMakeFiles\opencv_calib3d.dir\build.make:137: recipe for target &apos;modules/calib3d/CMakeFiles/opencv_calib3d.dir/src/chessboard.cpp.obj&apos; failed</span><br><span class="line">mingw32-make[2]: *** [modules/calib3d/CMakeFiles/opencv_calib3d.dir/src/chessboard.cpp.obj] Error 1</span><br><span class="line">CMakeFiles\Makefile2:3018: recipe for target &apos;modules/calib3d/CMakeFiles/opencv_calib3d.dir/all&apos; failed</span><br><span class="line">mingw32-make[1]: *** [modules/calib3d/CMakeFiles/opencv_calib3d.dir/all] Error 2</span><br><span class="line">Makefile:161: recipe for target &apos;all&apos; failed</span><br><span class="line">mingw32-make: *** [all] Error 2</span><br></pre></td></tr></table></figure><p><img src="http://ojlsgreog.bkt.clouddn.com/20180925221908.png" alt=""></p><h4 id="原因-1"><a href="#原因-1" class="headerlink" title="原因"></a>原因</h4><p>因为 OpenCV 在 <code>chessboard.cpp</code>、<code>chessboard.hpp</code>、<code>test_chesscorners.cpp</code> 这些代码中有 BUG，使用的应该是 <code>CV_PI</code> 而不是 <code>M_PI</code> 导致的。具体见我提的 Issue：<a href="https://github.com/opencv/opencv/issues/12642" target="_blank" rel="noopener">Failed to compile opencv-4.0.0-alpha using mingw-w64</a></p><h4 id="解决-2"><a href="#解决-2" class="headerlink" title="解决"></a>解决</h4><ul><li><p>在最新的 master 分支已经解决了这个问题，见我的 pull ：<a href="https://github.com/opencv/opencv/pull/12645" target="_blank" rel="noopener">M_PI changed to CV_PI</a></p></li><li><p>如果你是在 <a href="https://opencv.org/releases.html" target="_blank" rel="noopener">官网</a> 或者 <a href="https://github.com/opencv/opencv/releases" target="_blank" rel="noopener">github.com/opencv/opencv/releases</a> 中下的 <code>OpenCV 4.0.0-alpha</code>，可能还会有这个问题，那么你需要把 <code>chessboard.cpp</code>、<code>chessboard.hpp</code>、<code>test_chesscorners.cpp</code> 文件中的 <code>M_PI</code> 全部改为 <code>CV_PI</code>，如我的 commit 所示：<a href="https://github.com/opencv/opencv/commit/f0d277e45246762866daea036558e2c391b39ace" target="_blank" rel="noopener">M_PI changed to CV_PI (#12645)</a></p></li></ul><p>然后重新 <code>Configure</code>-<code>Generate</code>-<code>mingw32-make</code></p><h3 id="其他错误"><a href="#其他错误" class="headerlink" title="其他错误"></a>其他错误</h3><p>如果以上错误不是你所遇到的，请务必先看下面两个文章中的错误。</p><ul><li><a href="https://blog.huihut.com/2017/12/03/CompiledOpenCVRunInQt/">编译 32位 OpenCV 博文的常见错误</a></li><li><a href="http://visp-doc.inria.fr/doxygen/visp-daily/tutorial-install-win10-mingw64.html" target="_blank" rel="noopener">Tutorial: Installation from source for Windows with Mingw-w64</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;之前写过的一篇博文：&lt;a href=&quot;https://blog.huihut.com/2017/12/03/CompiledOpenCVRunInQt/&quot;&gt;OpenCV使用CMake和MinGW的编译安装及其在Qt配置运行&lt;/a&gt; 是使用 32 位的 MinGW 在 Windows 下编译 OpenCV 生成 32 位的 dll。&lt;/p&gt;
&lt;p&gt;而这篇博文是使用 64 位的 MinGW 编译 OpenCV 生成 64 位的 dll。&lt;/p&gt;
&lt;p&gt;因为博主没有 64 位 qmake，所以没勾选 &lt;code&gt;WITH_QT&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;2018年10月13日为 OpenCV-4.0.0-alpha 而修改，主要改了 “编译 OpenCV 常见错误”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;编译好的-OpenCV（MinGW-版）：&quot;&gt;&lt;a href=&quot;#编译好的-OpenCV（MinGW-版）：&quot; class=&quot;headerlink&quot; title=&quot;编译好的 OpenCV（MinGW 版）：&quot;&gt;&lt;/a&gt;编译好的 OpenCV（MinGW 版）：&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/huihut/OpenCV-MinGW-Build&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Github . huihut/OpenCV-MinGW-Build&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="链接装载库" scheme="https://blog.huihut.com/tags/%E9%93%BE%E6%8E%A5%E8%A3%85%E8%BD%BD%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>Linux 下 CLion 编写调用 C++ 共享库</title>
    <link href="https://blog.huihut.com/2018/07/20/WritingCppSharedLibraryOnLinuxCLion/"/>
    <id>https://blog.huihut.com/2018/07/20/WritingCppSharedLibraryOnLinuxCLion/</id>
    <published>2018-07-20T14:35:10.000Z</published>
    <updated>2018-07-20T14:35:55.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="编写-MySharedLib-共享库"><a href="#编写-MySharedLib-共享库" class="headerlink" title="编写 MySharedLib 共享库"></a>编写 MySharedLib 共享库</h2><p>创建一个名为 MySharedLib 的共享库</p><p>CMakeLists.txt<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.10</span>)</span><br><span class="line"><span class="keyword">project</span>(MySharedLib)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">11</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_library</span>(MySharedLib SHARED library.cpp library.h)</span><br></pre></td></tr></table></figure></p><a id="more"></a><p>library.h<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MYSHAREDLIB_LIBRARY_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MYSHAREDLIB_LIBRARY_H</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印 Hello World!</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用可变模版参数求和</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">T <span class="title">sum</span><span class="params">(T t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> ...Types&gt;</span><br><span class="line"><span class="function">T <span class="title">sum</span><span class="params">(T first, Types ... rest)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> first + sum&lt;T&gt;(rest...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure></p><p>library.cpp<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"library.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Hello, World!"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="被-TestSharedLib-可执行项目调用"><a href="#被-TestSharedLib-可执行项目调用" class="headerlink" title="被 TestSharedLib 可执行项目调用"></a>被 TestSharedLib 可执行项目调用</h2><p>创建一个名为 TestSharedLib 的可执行项目</p><p>CMakeLists.txt<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.10</span>)</span><br><span class="line"><span class="keyword">project</span>(TestSharedLib)</span><br><span class="line"></span><br><span class="line"><span class="comment"># C++11 编译</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">11</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 头文件路径</span></span><br><span class="line"><span class="keyword">set</span>(INC_DIR /home/xx/code/clion/MySharedLib)</span><br><span class="line"><span class="comment"># 库文件路径</span></span><br><span class="line"><span class="keyword">set</span>(LIB_DIR /home/xx/code/clion/MySharedLib/cmake-build-debug)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;INC_DIR&#125;</span>)</span><br><span class="line"><span class="keyword">link_directories</span>(<span class="variable">$&#123;LIB_DIR&#125;</span>)</span><br><span class="line"><span class="keyword">link_libraries</span>(MySharedLib)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(TestSharedLib main.cpp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 链接 MySharedLib 库</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(TestSharedLib MySharedLib)</span><br></pre></td></tr></table></figure></p><p>main.cpp<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"library.h"</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">hello();</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"1 + 2 = "</span> &lt;&lt; sum(<span class="number">1</span>,<span class="number">2</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"1 + 2 + 3 = "</span> &lt;&lt; sum(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>执行结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello, World!</span><br><span class="line">1 + 2 = 3</span><br><span class="line">1 + 2 + 3 = 6</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;编写-MySharedLib-共享库&quot;&gt;&lt;a href=&quot;#编写-MySharedLib-共享库&quot; class=&quot;headerlink&quot; title=&quot;编写 MySharedLib 共享库&quot;&gt;&lt;/a&gt;编写 MySharedLib 共享库&lt;/h2&gt;&lt;p&gt;创建一个名为 MySharedLib 的共享库&lt;/p&gt;
&lt;p&gt;CMakeLists.txt&lt;br&gt;&lt;figure class=&quot;highlight cmake&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;cmake_minimum_required&lt;/span&gt;(VERSION &lt;span class=&quot;number&quot;&gt;3.10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;project&lt;/span&gt;(MySharedLib)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;set&lt;/span&gt;(CMAKE_CXX_STANDARD &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;add_library&lt;/span&gt;(MySharedLib SHARED library.cpp library.h)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="C/C++" scheme="https://blog.huihut.com/tags/C-C/"/>
    
  </entry>
  
  <entry>
    <title>UWP 动画改变控件大小（高度）</title>
    <link href="https://blog.huihut.com/2018/07/18/UWPAnimationChangesControlHeight/"/>
    <id>https://blog.huihut.com/2018/07/18/UWPAnimationChangesControlHeight/</id>
    <published>2018-07-18T15:09:46.000Z</published>
    <updated>2018-07-20T14:56:03.000Z</updated>
    
    <content type="html"><![CDATA[<p>有这样一个需求：</p><ul><li>鼠标移动到（悬停在）控件上（PointerEntered），控件大小（高度）发生变化，以显示更多内容；</li><li>鼠标移出控件（PointerExited），控件大小恢复原状。</li></ul><p>本文通过 UWP 动画，用两种方法实现这个效果，用于改变周贡献榜和粉丝榜的 Grid 的高度。</p><a id="more"></a><h2 id="方法一：XAML-实现动画"><a href="#方法一：XAML-实现动画" class="headerlink" title="方法一：XAML 实现动画"></a>方法一：XAML 实现动画</h2><h3 id="XAML："><a href="#XAML：" class="headerlink" title="XAML："></a>XAML：</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">UserControl.Resources</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--周贡、粉丝榜下拉恢复动画--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Storyboard</span> <span class="attr">x:Name</span>=<span class="string">"SeeMoreAnimation"</span> <span class="attr">Storyboard.TargetName</span>=<span class="string">"WeekFansGrid"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DoubleAnimation</span> <span class="attr">Duration</span>=<span class="string">"0:0:0.2"</span> <span class="attr">EnableDependentAnimation</span>=<span class="string">"True"</span> <span class="attr">Storyboard.TargetProperty</span>=<span class="string">"Height"</span> <span class="attr">From</span>=<span class="string">"140"</span> <span class="attr">To</span>=<span class="string">"400"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Storyboard</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Storyboard</span> <span class="attr">x:Name</span>=<span class="string">"RestoreAnimation"</span> <span class="attr">Storyboard.TargetName</span>=<span class="string">"WeekFansGrid"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DoubleAnimation</span>  <span class="attr">Duration</span>=<span class="string">"0:0:0.2"</span> <span class="attr">EnableDependentAnimation</span>=<span class="string">"True"</span> <span class="attr">Storyboard.TargetProperty</span>=<span class="string">"Height"</span> <span class="attr">From</span>=<span class="string">"400"</span> <span class="attr">To</span>=<span class="string">"140"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Storyboard</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">UserControl.Resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">Grid</span> <span class="attr">x:Name</span>=<span class="string">"WeekFansGrid"</span> <span class="attr">Background</span>=<span class="string">"White"</span> <span class="attr">VerticalAlignment</span>=<span class="string">"Top"</span> <span class="attr">Height</span>=<span class="string">"140"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">PointerEntered</span>=<span class="string">"Grid_PointerEntered"</span> <span class="attr">PointerExited</span>=<span class="string">"Grid_PointerExited"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Grid 里面的一些内容--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="C-："><a href="#C-：" class="headerlink" title="C#："></a>C#：</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 鼠标悬停周贡、粉丝榜的 Grid</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Grid_PointerEntered</span>(<span class="params"><span class="keyword">object</span> sender, PointerRoutedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        SeeMoreAnimation.Begin();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception e1)</span><br><span class="line">    &#123;</span><br><span class="line">        System.Diagnostics.Debug.WriteLine(<span class="string">"Grid_PointerEntered "</span> + e1.Message.ToString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 鼠标离开周贡、粉丝榜的 Grid</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Grid_PointerExited</span>(<span class="params"><span class="keyword">object</span> sender, PointerRoutedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        RestoreAnimation.Begin();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception e1)</span><br><span class="line">    &#123;</span><br><span class="line">        System.Diagnostics.Debug.WriteLine(<span class="string">"Grid_PointerExited "</span> + e1.Message.ToString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="方法二：后台实现动画"><a href="#方法二：后台实现动画" class="headerlink" title="方法二：后台实现动画"></a>方法二：后台实现动画</h2><h3 id="XAML：-1"><a href="#XAML：-1" class="headerlink" title="XAML："></a>XAML：</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Grid</span> <span class="attr">x:Name</span>=<span class="string">"WeekFansGrid"</span> <span class="attr">Background</span>=<span class="string">"White"</span> <span class="attr">VerticalAlignment</span>=<span class="string">"Top"</span> <span class="attr">Height</span>=<span class="string">"140"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">PointerEntered</span>=<span class="string">"Grid_PointerEntered"</span> <span class="attr">PointerExited</span>=<span class="string">"Grid_PointerExited"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Grid 里面的一些内容--&gt;</span>     </span><br><span class="line"><span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="C-：-1"><a href="#C-：-1" class="headerlink" title="C#："></a>C#：</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 鼠标悬停周贡、粉丝榜的 Grid</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Grid_PointerEntered</span>(<span class="params"><span class="keyword">object</span> sender, PointerRoutedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        Grid grid = sender <span class="keyword">as</span> Grid;</span><br><span class="line">        <span class="keyword">if</span> (grid != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            DoubleAnimation SeeMoreAnimation = <span class="keyword">new</span> DoubleAnimation();</span><br><span class="line">            <span class="keyword">if</span> (SeeMoreAnimation != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 高度从 140 变化到 400</span></span><br><span class="line">                SeeMoreAnimation.From = <span class="number">140</span>;</span><br><span class="line">                SeeMoreAnimation.To = <span class="number">400</span>;</span><br><span class="line">                <span class="comment">// 用时 200 毫秒</span></span><br><span class="line">                SeeMoreAnimation.Duration = <span class="keyword">new</span> Duration(TimeSpan.FromMilliseconds(<span class="number">200</span>));</span><br><span class="line">                SeeMoreAnimation.EnableDependentAnimation = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 目标 Grid 的 Height</span></span><br><span class="line">                Storyboard.SetTarget(SeeMoreAnimation, grid);</span><br><span class="line">                Storyboard.SetTargetProperty(SeeMoreAnimation, <span class="string">"Height"</span>);</span><br><span class="line"></span><br><span class="line">                Storyboard storyboard = <span class="keyword">new</span> Storyboard();</span><br><span class="line">                <span class="keyword">if</span> (storyboard != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    storyboard.Children.Add(SeeMoreAnimation);</span><br><span class="line">                    <span class="comment">// 执行动画</span></span><br><span class="line">                    storyboard.Begin();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception e1)</span><br><span class="line">    &#123;</span><br><span class="line">        System.Diagnostics.Debug.WriteLine(<span class="string">"Grid_PointerEntered "</span> + e1.Message.ToString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 鼠标离开周贡、粉丝榜的 Grid</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Grid_PointerExited</span>(<span class="params"><span class="keyword">object</span> sender, PointerRoutedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        Grid grid = sender <span class="keyword">as</span> Grid;</span><br><span class="line">        <span class="keyword">if</span> (grid != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            DoubleAnimation SeeMoreAnimation = <span class="keyword">new</span> DoubleAnimation();</span><br><span class="line">            <span class="keyword">if</span> (SeeMoreAnimation != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 高度从 400 变化到 140</span></span><br><span class="line">                SeeMoreAnimation.From = <span class="number">400</span>;</span><br><span class="line">                SeeMoreAnimation.To = <span class="number">140</span>;</span><br><span class="line">                <span class="comment">// 用时 200 毫秒</span></span><br><span class="line">                SeeMoreAnimation.Duration = <span class="keyword">new</span> Duration(TimeSpan.FromMilliseconds(<span class="number">200</span>));</span><br><span class="line">                SeeMoreAnimation.EnableDependentAnimation = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 目标 Grid 的 Height</span></span><br><span class="line">                Storyboard.SetTarget(SeeMoreAnimation, grid);</span><br><span class="line">                Storyboard.SetTargetProperty(SeeMoreAnimation, <span class="string">"Height"</span>);</span><br><span class="line"></span><br><span class="line">                Storyboard storyboard = <span class="keyword">new</span> Storyboard();</span><br><span class="line">                <span class="keyword">if</span> (storyboard != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    storyboard.Children.Add(SeeMoreAnimation);</span><br><span class="line">                    <span class="comment">// 执行动画</span></span><br><span class="line">                    storyboard.Begin();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception e1)</span><br><span class="line">    &#123;</span><br><span class="line">        System.Diagnostics.Debug.WriteLine(<span class="string">"Grid_PointerExited "</span> + e1.Message.ToString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h2><p><img src="http://ojlsgreog.bkt.clouddn.com/GridSeeMoreAnimation1.gif" alt="GridSeeMoreAnimation"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;有这样一个需求：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;鼠标移动到（悬停在）控件上（PointerEntered），控件大小（高度）发生变化，以显示更多内容；&lt;/li&gt;
&lt;li&gt;鼠标移出控件（PointerExited），控件大小恢复原状。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;本文通过 UWP 动画，用两种方法实现这个效果，用于改变周贡献榜和粉丝榜的 Grid 的高度。&lt;/p&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="UWP" scheme="https://blog.huihut.com/tags/UWP/"/>
    
  </entry>
  
  <entry>
    <title>Python 生成带标签数据集的 CSV 文件</title>
    <link href="https://blog.huihut.com/2018/06/17/UsingPythonToCreateCSV/"/>
    <id>https://blog.huihut.com/2018/06/17/UsingPythonToCreateCSV/</id>
    <published>2018-06-17T15:48:32.000Z</published>
    <updated>2018-06-17T16:14:57.000Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Python 生成 CSV 文件</span></span><br><span class="line"><span class="comment"># Python 生成 CSV 文件，可用于生成带标签的数据集 CSV 文件，标签从0开始自动升序：0,1,2,3...</span></span><br><span class="line"><span class="comment"># 作者：huihut</span></span><br><span class="line"><span class="comment"># 仓库：https://gist.github.com/huihut/9881c98a1d9279d4fa9dfd8475e3fe4b</span></span><br><span class="line"><span class="comment"># 参考：https://github.com/opencv/opencv_attic/blob/master/opencv/modules/contrib/doc/facerec/src/create_csv.py</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">使用脚本：</span></span><br><span class="line"><span class="string">* python create_csv.py &lt;base_path&gt; [save_path]</span></span><br><span class="line"><span class="string">例如：</span></span><br><span class="line"><span class="string">* python create_csv.py /Users/xx/code/dataset</span></span><br><span class="line"><span class="string">* python create_csv.py /Users/xx/code/dataset ./dataset_csv.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">目录结构（使用 tree 命令查看）：</span></span><br><span class="line"><span class="string">xx@xxs-MacBook-Pro:~/code/dataset$ tree</span></span><br><span class="line"><span class="string">.</span></span><br><span class="line"><span class="string">├── README</span></span><br><span class="line"><span class="string">├── dataset_csv.txt</span></span><br><span class="line"><span class="string">├── s01</span></span><br><span class="line"><span class="string">│   ├── 01.pgm</span></span><br><span class="line"><span class="string">│   ├── ...</span></span><br><span class="line"><span class="string">│   └── 10.pgm</span></span><br><span class="line"><span class="string">├── s02</span></span><br><span class="line"><span class="string">│   ├── 01.pgm</span></span><br><span class="line"><span class="string">│   ├── ...</span></span><br><span class="line"><span class="string">│   └── 10.pgm</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">└── s10</span></span><br><span class="line"><span class="string">    ├── 01.pgm</span></span><br><span class="line"><span class="string">    ├── ...</span></span><br><span class="line"><span class="string">    └── 10.pgm</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">生成的 CSV 文件内容（使用 cat 命令查看 dataset_csv.txt 文件内容）：</span></span><br><span class="line"><span class="string">xx@xxs-MacBook-Pro:~/code/dataset$ cat dataset_csv.txt</span></span><br><span class="line"><span class="string">/Users/xx/code/dataset/s01/01.pgm;0</span></span><br><span class="line"><span class="string">/Users/xx/code/dataset/s01/02.pgm;0</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">/Users/xx/code/dataset/s01/10.pgm;0</span></span><br><span class="line"><span class="string">/Users/xx/code/dataset/s02/01.pgm;1</span></span><br><span class="line"><span class="string">/Users/xx/code/dataset/s02/02.pgm;1</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">/Users/xx/code/dataset/s10/01.pgm;9</span></span><br><span class="line"><span class="string">/Users/xx/code/dataset/s10/02.pgm;9</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">/Users/xx/code/dataset/s10/10.pgm;9</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    </span><br><span class="line">    SAVE_PATH = <span class="string">"./dataset_csv.txt"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (len(sys.argv) != <span class="number">2</span> <span class="keyword">and</span> len(sys.argv) != <span class="number">3</span>):</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"usage:"</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* python create_csv.py &lt;base_path&gt; [save_path]"</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"example:"</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* python create_csv.py /Users/xx/code/dataset"</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* python create_csv.py /Users/xx/code/dataset ./dataset_csv.txt"</span></span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">elif</span> (len(sys.argv) == <span class="number">3</span>):</span><br><span class="line">        SAVE_PATH = sys.argv[<span class="number">2</span>]</span><br><span class="line">    </span><br><span class="line">    BASE_PATH = sys.argv[<span class="number">1</span>]</span><br><span class="line">    SEPARATOR = <span class="string">";"</span></span><br><span class="line">    fh = open(SAVE_PATH,<span class="string">'w'</span>)</span><br><span class="line"></span><br><span class="line">    label = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> dirname, dirnames, filenames <span class="keyword">in</span> os.walk(BASE_PATH):</span><br><span class="line">        <span class="keyword">for</span> subdirname <span class="keyword">in</span> dirnames:</span><br><span class="line">            subject_path = os.path.join(dirname, subdirname)</span><br><span class="line">            <span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(subject_path):</span><br><span class="line">                abs_path = <span class="string">"%s/%s"</span> % (subject_path, filename)</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"%s%s%d"</span> % (abs_path, SEPARATOR, label)</span><br><span class="line">                fh.write(abs_path + SEPARATOR + str(label) + <span class="string">"\n"</span>)</span><br><span class="line">            label = label + <span class="number">1</span></span><br><span class="line">    fh.close()</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span clas
      
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="Python" scheme="https://blog.huihut.com/tags/Python/"/>
    
      <category term="ML" scheme="https://blog.huihut.com/tags/ML/"/>
    
  </entry>
  
  <entry>
    <title>VSCode 的 C/C++ 调试环境的 launch.json、 tasks.json 文件</title>
    <link href="https://blog.huihut.com/2018/06/12/VSCodeCppLaunchTasks/"/>
    <id>https://blog.huihut.com/2018/06/12/VSCodeCppLaunchTasks/</id>
    <published>2018-06-12T13:32:13.000Z</published>
    <updated>2018-10-13T06:38:21.526Z</updated>
    
    <content type="html"><![CDATA[<h2 id="launch-json"><a href="#launch-json" class="headerlink" title="launch.json"></a>launch.json</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Configuring tasks.json for C/C++ debugging</span></span><br><span class="line"><span class="comment">// author: huihut</span></span><br><span class="line"><span class="comment">// repo: https://gist.github.com/huihut/9548fe7e1084cf8e844120c5668b8177</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Available variables which can be used inside of strings.</span></span><br><span class="line"><span class="comment">// $&#123;workspaceRoot&#125;: the root folder of the team        </span></span><br><span class="line"><span class="comment">// $&#123;file&#125;: the current opened file                     </span></span><br><span class="line"><span class="comment">// $&#123;fileBasename&#125;: the current opened file's basename </span></span><br><span class="line"><span class="comment">// $&#123;fileDirname&#125;: the current opened file's dirname    </span></span><br><span class="line"><span class="comment">// $&#123;fileExtname&#125;: the current opened file's extension  </span></span><br><span class="line"><span class="comment">// $&#123;cwd&#125;: the current working directory of the spawned process</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">    <span class="string">"configurations"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"name"</span>: <span class="string">"(gdb) Launch"</span>,</span><br><span class="line">            <span class="string">"preLaunchTask"</span>: <span class="string">"build"</span>,</span><br><span class="line">            <span class="string">"type"</span>: <span class="string">"cppdbg"</span>,</span><br><span class="line">            <span class="string">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">            <span class="string">"program"</span>: <span class="string">"$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;.exe"</span>,</span><br><span class="line">            <span class="string">"args"</span>: [],</span><br><span class="line">            <span class="string">"stopAtEntry"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"cwd"</span>: <span class="string">"$&#123;workspaceFolder&#125;"</span>,</span><br><span class="line">            <span class="string">"environment"</span>: [],</span><br><span class="line">            <span class="string">"externalConsole"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"MIMode"</span>: <span class="string">"gdb"</span>,</span><br><span class="line">            <span class="string">"miDebuggerPath"</span>: <span class="string">"gdb.exe"</span>,</span><br><span class="line">            <span class="string">"setupCommands"</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"description"</span>: <span class="string">"Enable pretty-printing for gdb"</span>,</span><br><span class="line">                    <span class="string">"text"</span>: <span class="string">"-enable-pretty-printing"</span>,</span><br><span class="line">                    <span class="string">"ignoreFailures"</span>: <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="tasks-json"><a href="#tasks-json" class="headerlink" title="tasks.json"></a>tasks.json</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Configuring tasks.json for C/C++ debugging </span></span><br><span class="line"><span class="comment">// author: huihut</span></span><br><span class="line"><span class="comment">// repo: https://gist.github.com/huihut/887d3c28db92617bd5148c20a5ff112a</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Available variables which can be used inside of strings.</span></span><br><span class="line"><span class="comment">// $&#123;workspaceRoot&#125;: the root folder of the team        </span></span><br><span class="line"><span class="comment">// $&#123;file&#125;: the current opened file                     </span></span><br><span class="line"><span class="comment">// $&#123;fileBasename&#125;: the current opened file's basename </span></span><br><span class="line"><span class="comment">// $&#123;fileDirname&#125;: the current opened file's dirname    </span></span><br><span class="line"><span class="comment">// $&#123;fileExtname&#125;: the current opened file's extension  </span></span><br><span class="line"><span class="comment">// $&#123;cwd&#125;: the current working directory of the spawned process</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"version"</span>: <span class="string">"2.0.0"</span>,</span><br><span class="line">    <span class="string">"tasks"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"label"</span>: <span class="string">"build"</span>,</span><br><span class="line">            <span class="string">"type"</span>: <span class="string">"shell"</span>,</span><br><span class="line">            <span class="string">"group"</span>: &#123;</span><br><span class="line">                <span class="string">"kind"</span>: <span class="string">"build"</span>,</span><br><span class="line">                <span class="string">"isDefault"</span>: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"presentation"</span>: &#123;</span><br><span class="line">                <span class="string">"echo"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="string">"reveal"</span>: <span class="string">"always"</span>,</span><br><span class="line">                <span class="string">"focus"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="string">"panel"</span>: <span class="string">"shared"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"windows"</span>: &#123;</span><br><span class="line">                <span class="string">"command"</span>: <span class="string">"g++"</span>,</span><br><span class="line">                <span class="string">"args"</span>: [</span><br><span class="line">                    <span class="string">"-ggdb"</span>,</span><br><span class="line">                    <span class="string">"\"$&#123;file&#125;\""</span>,</span><br><span class="line">                    <span class="string">"--std=c++11"</span>,</span><br><span class="line">                    <span class="string">"-o"</span>,</span><br><span class="line">                    <span class="string">"\"$&#123;fileDirname&#125;\\$&#123;fileBasenameNoExtension&#125;.exe\""</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;launch-json&quot;&gt;&lt;a href=&quot;#launch-json&quot; class=&quot;headerlink&quot; title=&quot;launch.json&quot;&gt;&lt;/a&gt;launch.json&lt;/h2&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Configuring tasks.json for C/C++ debugging&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// author: huihut&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// repo: https://gist.github.com/huihut/9548fe7e1084cf8e844120c5668b8177&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Available variables which can be used inside of strings.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// $&amp;#123;workspaceRoot&amp;#125;: the root folder of the team        &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// $&amp;#123;file&amp;#125;: the current opened file                     &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// $&amp;#123;fileBasename&amp;#125;: the current opened file&#39;s basename &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// $&amp;#123;fileDirname&amp;#125;: the current opened file&#39;s dirname    &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// $&amp;#123;fileExtname&amp;#125;: the current opened file&#39;s extension  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// $&amp;#123;cwd&amp;#125;: the current working directory of the spawned process&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;version&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;0.2.0&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;configurations&quot;&lt;/span&gt;: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;(gdb) Launch&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;preLaunchTask&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;build&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;cppdbg&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;request&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;launch&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;program&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;$&amp;#123;fileDirname&amp;#125;/$&amp;#123;fileBasenameNoExtension&amp;#125;.exe&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;args&quot;&lt;/span&gt;: [],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;stopAtEntry&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;cwd&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;$&amp;#123;workspaceFolder&amp;#125;&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;environment&quot;&lt;/span&gt;: [],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;externalConsole&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;MIMode&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;gdb&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;miDebuggerPath&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;gdb.exe&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;setupCommands&quot;&lt;/span&gt;: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;string&quot;&gt;&quot;description&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;Enable pretty-printing for gdb&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;-enable-pretty-printing&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;string&quot;&gt;&quot;ignoreFailures&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="C/C++" scheme="https://blog.huihut.com/tags/C-C/"/>
    
  </entry>
  
  <entry>
    <title>C++ 调用 Python 模块</title>
    <link href="https://blog.huihut.com/2018/06/12/CppCallPython/"/>
    <id>https://blog.huihut.com/2018/06/12/CppCallPython/</id>
    <published>2018-06-12T13:28:57.000Z</published>
    <updated>2018-10-13T06:37:23.034Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// C++ call Python module </span></span><br><span class="line"><span class="comment">// author: huihut</span></span><br><span class="line"><span class="comment">// repo: https://gist.github.com/huihut/b4597d097123a8c8388c71b3f0ff21e5</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Python.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// C++ call Python module</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">CppCallPython</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Python initialize</span></span><br><span class="line">    Py_Initialize();</span><br><span class="line">    <span class="keyword">if</span> (!Py_IsInitialized())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Python initialization failed!\n"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If my MyPython.py file is in "/Users/xx/code", set the working path to "/Users/xx/code"</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> path = <span class="string">"/Users/xx/code"</span>;</span><br><span class="line">    PySys_SetPath(&amp;path[<span class="number">0u</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Import MyPython.py module</span></span><br><span class="line">    PyObject* pModule = PyImport_ImportModule(<span class="string">"MyPython"</span>);</span><br><span class="line">    <span class="keyword">if</span> (!pModule)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt;<span class="string">"Cannot open Python file!\n"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get the HelloPython() function in the module</span></span><br><span class="line">    PyObject* pFunhello = PyObject_GetAttrString(pModule, <span class="string">"HelloPython"</span>);</span><br><span class="line">    <span class="keyword">if</span> (!pFunhello)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Failed to get this function!"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Call HelloPython()</span></span><br><span class="line">    PyObject_CallFunction(pFunhello, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Finalize</span></span><br><span class="line">    Py_Finalize();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;
      
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="C/C++" scheme="https://blog.huihut.com/tags/C-C/"/>
    
      <category term="Python" scheme="https://blog.huihut.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>C++ 使用 Qt 生成带标签数据集的 CSV 文件</title>
    <link href="https://blog.huihut.com/2018/06/12/UsingQtToCreateCSV/"/>
    <id>https://blog.huihut.com/2018/06/12/UsingQtToCreateCSV/</id>
    <published>2018-06-12T13:25:51.000Z</published>
    <updated>2018-10-13T06:38:17.181Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// C++ 使用 Qt 生成 CSV 文件</span></span><br><span class="line"><span class="comment">// 以下函数实现生成特定类型的 CSV 文件，可用于生成带标签的数据集 CSV 文件，标签为图片上一级的文件夹名字。</span></span><br><span class="line"><span class="comment">// 作者：huihut</span></span><br><span class="line"><span class="comment">// 仓库：https://gist.github.com/huihut/c9f43e276ef7652f0471725482a1e4f6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">目录结构（使用 tree 命令查看）：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">xx@xxs-MacBook-Pro:~/code/dataset$ tree</span></span><br><span class="line"><span class="comment">.</span></span><br><span class="line"><span class="comment">├── README</span></span><br><span class="line"><span class="comment">├── dataset_csv.txt</span></span><br><span class="line"><span class="comment">├── s01</span></span><br><span class="line"><span class="comment">│   ├── 01.pgm</span></span><br><span class="line"><span class="comment">│   ├── ...</span></span><br><span class="line"><span class="comment">│   └── 10.pgm</span></span><br><span class="line"><span class="comment">├── s02</span></span><br><span class="line"><span class="comment">│   ├── 01.pgm</span></span><br><span class="line"><span class="comment">│   ├── ...</span></span><br><span class="line"><span class="comment">│   └── 10.pgm</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">└── s10</span></span><br><span class="line"><span class="comment">    ├── 01.pgm</span></span><br><span class="line"><span class="comment">    ├── ...</span></span><br><span class="line"><span class="comment">    └── 10.pgm</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">-----------------------------------------------------------</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">生成的 CSV 文件内容（使用 cat 命令查看 dataset_csv.txt 文件内容）：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">xx@xxs-MacBook-Pro:~/code/dataset$ cat dataset_csv.txt</span></span><br><span class="line"><span class="comment">/Users/xx/code/dataset/s01/01.pgm,s01</span></span><br><span class="line"><span class="comment">/Users/xx/code/dataset/s01/02.pgm,s01</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">/Users/xx/code/dataset/s01/10.pgm,s01</span></span><br><span class="line"><span class="comment">/Users/xx/code/dataset/s02/01.pgm,s02</span></span><br><span class="line"><span class="comment">/Users/xx/code/dataset/s02/02.pgm,s02</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">/Users/xx/code/dataset/s10/01.pgm,s10</span></span><br><span class="line"><span class="comment">/Users/xx/code/dataset/s10/02.pgm,s10</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">/Users/xx/code/dataset/s10/10.pgm,s10</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDir&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDirIterator&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">CreateCSV</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 数据集的基础路径</span></span><br><span class="line">    QString datasetdir = <span class="string">"/Users/xx/code/dataset"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成的 CSV 文件的名字</span></span><br><span class="line">    QString csvName = <span class="string">"dataset_csv.txt"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 数据集路径与数据集名字的分隔符</span></span><br><span class="line">    <span class="keyword">char</span> separator = <span class="string">','</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 数据集路径、数据集名字</span></span><br><span class="line">    QString datasetPath, datasetName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 文件迭代器：获取指定类型（以下是 pgm、png、jpg 三种类型）的数据集文件</span></span><br><span class="line">    <span class="function">QDirIterator <span class="title">it</span><span class="params">(datasetdir, QStringList() &lt;&lt; <span class="string">"*.pgm"</span> &lt;&lt; <span class="string">"*.png"</span> &lt;&lt; <span class="string">"*.jpg"</span>, QDir::Files, QDirIterator::Subdirectories)</span></span>;</span><br><span class="line">    <span class="keyword">if</span>(!it.hasNext())</span><br><span class="line">    &#123;</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"当前路径下数据集为空！\n"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建及打开 CSV 文件</span></span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(datasetdir + QDir::toNativeSeparators(<span class="string">"/"</span>) + csvName)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!file.open(QIODevice::WriteOnly | QIODevice::Text))</span><br><span class="line">    &#123;</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"打开 CSV 文件失败！\n"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 文件写的文本流</span></span><br><span class="line">    <span class="function">QTextStream <span class="title">csv_ts</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 文件迭代器中有指定数据集文件则依次迭代</span></span><br><span class="line">    <span class="keyword">while</span> (it.hasNext())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 数据集路径</span></span><br><span class="line">        datasetPath = it.next();</span><br><span class="line">        <span class="comment">// 数据集名字</span></span><br><span class="line">        datasetName = datasetPath.section(QDir::toNativeSeparators(<span class="string">"/"</span>), <span class="number">-2</span>, <span class="number">-2</span>);</span><br><span class="line">        <span class="comment">// 写入文本流</span></span><br><span class="line">        csv_ts &lt;&lt; datasetPath &lt;&lt; separator &lt;&lt; datasetName &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 关闭文本流</span></span><br><span class="line">    file.close();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;
      
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="QT" scheme="https://blog.huihut.com/tags/QT/"/>
    
      <category term="ML" scheme="https://blog.huihut.com/tags/ML/"/>
    
  </entry>
  
  <entry>
    <title>Qt GDB 无法调试 MSVC 编译的程序而报错：file format not recognized</title>
    <link href="https://blog.huihut.com/2018/06/02/QtNotInExecutableFormat/"/>
    <id>https://blog.huihut.com/2018/06/02/QtNotInExecutableFormat/</id>
    <published>2018-06-02T05:11:56.000Z</published>
    <updated>2018-10-13T06:38:07.873Z</updated>
    
    <content type="html"><![CDATA[<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><ul><li>Windows 10 x64</li><li>Visual Studio 2017</li><li>Qt 5.11</li></ul><h2 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h2><p>Qt Debug 时提示异常：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qt not in executable format. file format not recognized</span><br></pre></td></tr></table></figure><a id="more"></a><p><img src="http://ojlsgreog.bkt.clouddn.com/qt-not-in-executable-format-file-format-not-recognized.PNG" alt="qt-not-in-executable-format-file-format-not-recognized"></p><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>编译器（Compiler）使用了 64 位版本的 MSVC，调试器（Debugger）却使用了 32 位的 MinGW 的 GDB，从而 GDB 不能调试 64 位程序而报错。</p><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><ul><li>在 Qt 的 <code>工具</code> - <code>选项</code> - <code>构建和运行</code> - <code>Debuggers</code> 选择 CDB（Debugging Tools for Windows），</li><li>不能自动检测到则手动添加，如：<code>C:\Program Files (x86)\Windows Kits\10\Debuggers\x64\cdb.exe</code>，</li><li>没有 cdb 则下载：<a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk" target="_blank" rel="noopener">Windows Driver Kit (WDK)</a>（下载装好后重启 Qt 一般就可以自动检测到）</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;环境&quot;&gt;&lt;a href=&quot;#环境&quot; class=&quot;headerlink&quot; title=&quot;环境&quot;&gt;&lt;/a&gt;环境&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Windows 10 x64&lt;/li&gt;
&lt;li&gt;Visual Studio 2017&lt;/li&gt;
&lt;li&gt;Qt 5.11&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;异常&quot;&gt;&lt;a href=&quot;#异常&quot; class=&quot;headerlink&quot; title=&quot;异常&quot;&gt;&lt;/a&gt;异常&lt;/h2&gt;&lt;p&gt;Qt Debug 时提示异常：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;qt not in executable format. file format not recognized&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="QT" scheme="https://blog.huihut.com/tags/QT/"/>
    
  </entry>
  
  <entry>
    <title>一加 3T ROM、内核、固件、Recovery、框架、软件（APP）总结</title>
    <link href="https://blog.huihut.com/2018/05/11/awesome-oneplus-3t/"/>
    <id>https://blog.huihut.com/2018/05/11/awesome-oneplus-3t/</id>
    <published>2018-05-11T14:13:59.000Z</published>
    <updated>2018-10-13T06:37:25.686Z</updated>
    
    <content type="html"><![CDATA[<p>一加 3T ROM、内核（Kernel）、固件（Firmware）、Recovery、框架（Framework）、软件（APP），以备茶余饭后手贱刷机之用。</p><h2 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h2><ul><li>Github Repository： <a href="https://github.com/huihut/awesome-oneplus-3t" target="_blank" rel="noopener">huihut/awesome-oneplus-3t</a></li><li>之前的相关博文：<a href="https://blog.huihut.com/2017/08/27/Oneplus3TBrushAndPlay/">一加3T的刷机流程及玩机一些事</a></li></ul><a id="more"></a><h1 id="ROM"><a href="#ROM" class="headerlink" title="ROM"></a>ROM</h1><h2 id="基于-Android-8-1"><a href="#基于-Android-8-1" class="headerlink" title="基于 Android 8.1"></a>基于 Android 8.1</h2><ul><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-nitrogen-os-beta-t3737654" target="_blank" rel="noopener">NitrogenOS</a> | <a href="https://sourceforge.net/projects/nitrogen-project/files/oneplus3/oneplus3_test/8.1/" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/8-x-omni-oneplus-3t-t3695992" target="_blank" rel="noopener">Omni 8.1</a> | <a href="http://dl.omnirom.org/oneplus3/" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-kernel-resurrectionremix-n-t3524715" target="_blank" rel="noopener">[Official] ResurrectionRemix v6.0.0</a> | <a href="https://sourceforge.net/projects/resurrectionremix-oreo/files/oneplus3/" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-aospextended-rom-v3-1-t3557363" target="_blank" rel="noopener">AOSP Extended 5.4</a> | <a href="https://downloads.aospextended.com/oneplus3/" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-lineageos-15-1-oneplus-3-3t-t3739169" target="_blank" rel="noopener">LineageOS 15.1</a> | <a href="https://download.lineageos.org/oneplus3" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-havoc-os-t3782811" target="_blank" rel="noopener">Havoc-OS</a> | <a href="https://sourceforge.net/projects/havoc-os/files/oneplus3/" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/ground-zero-roms/ground-zero-roms-feature-development/rom-tesla-n-t3481561" target="_blank" rel="noopener">Validus 2.2</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=239521&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/wip-official-aicp-13-0-t3713637" target="_blank" rel="noopener">AICP 13.1</a> | <a href="http://dwnld.aicp-rom.com/?device=oneplus3" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-android-source-illusion-project-t3735128" target="_blank" rel="noopener">AOSiP</a> | <a href="https://get.aosiprom.com/oneplus3/" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/ground-zero-roms/ground-zero-roms-feature-development/gzosp-aio-thread-t3679343" target="_blank" rel="noopener">GZOSP 1.0</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=217699&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-candy8-1-alpha-t3743214" target="_blank" rel="noopener">Candy 8.1</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=235075&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/op3t-o-s-c-p-cypheros-t3744182" target="_blank" rel="noopener">A.O.S.C.P : CypherOS</a> | <a href="http://get.cypheros.co/" target="_blank" rel="noopener">官方下载</a> | <a href="https://mega.nz/#F!I1BUGSQY!yJoh7pjahDUM-NTBaq2_xA" target="_blank" rel="noopener">非官方下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/cardinal-aosp-5-0-android-8-0-pre-t3693585" target="_blank" rel="noopener">MSM Xtended</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=252432&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-cosmic-os-v3-1-universe-t3749543" target="_blank" rel="noopener">Cosmic-OS 3.1</a> | <a href="https://sourceforge.net/projects/cosmic-os/files/oneplus3/" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/op3-3t-resurrection-remix-t3754941" target="_blank" rel="noopener">[Unoffical] Resurrection Remix (LuisROM)</a> | <a href="http://luis-builds.de/downloads/lineageos/rr/oneplus3/" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-android-kang-project-aokp-t3571944/page16" target="_blank" rel="noopener">AOKP Oreo</a> | <a href="http://xfer.aokp.co/?developer=AOKP&amp;folder=oneplus3" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3t/development/rom-nlos-15-1-20180223-t3754855" target="_blank" rel="noopener">NLOS-15.1 beta</a> | <a href="https://drive.google.com/drive/folders/1kJFApe-XZaRwOyJFXgbsff0fE65SFi_7" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-tugapower-4-0-t3755049" target="_blank" rel="noopener">Tugapower</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=246534&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3t/how-to/rom-mokee-source-project-t3683456/post74031157#post74031157" target="_blank" rel="noopener">MoKee Open Source Project</a> | <a href="https://download.mokeedev.com/?device=oneplus3" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/op3-t-romcrdroid-t3763119" target="_blank" rel="noopener">crDroid</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=256882&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-bootleggersrom-2-1-stable-t3765818" target="_blank" rel="noopener">BootleggersROM</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=258189&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-aquarios-8-1-0-live-support-volte-t3768806" target="_blank" rel="noopener">AquariOS</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=259680&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-carbonrom-noct-weeklies-t3771205" target="_blank" rel="noopener">CarbonROM</a> | <a href="https://get.carbonrom.org/device-oneplus3.html" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-resurrectionremix-v6-0-0-t3769387" target="_blank" rel="noopener">[Unofficial] ResurrectionRemix v6.0.0</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=256927&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/rom-pixel-experience-t3729897" target="_blank" rel="noopener">Pixel Experience</a> | <a href="https://download.pixelexperience.org/oneplus3/" target="_blank" rel="noopener">下载</a></li></ul><h2 id="基于-Android-8-0"><a href="#基于-Android-8-0" class="headerlink" title="基于 Android 8.0"></a>基于 Android 8.0</h2><ul><li><a href="https://downloads.oneplus.com/oneplus-3t/oneplus_3t_oxygenos_5.0.1/" target="_blank" rel="noopener">[一加官方] OnePlus 3T 氧OS(OxygenOS) 5.0.1</a> | <a href="http://oxygenos.oneplus.net.s3.amazonaws.com/OnePlus3TOxygen_28_OTA_062_all_1712272248_d28093577f324959.zip" target="_blank" rel="noopener">下载</a></li><li><a href="https://downloads.oneplus.com/oneplus-3t/oneplus_3t_oxygenos_openbeta_26/" target="_blank" rel="noopener">[一加官方] OnePlus 3T 氧OS(OxygenOS) beta 26</a> | <a href="http://oxygenos.oneplus.net.s3.amazonaws.com/OnePlus3TOxygen_28_OTA_048_all_1804231749_97b9d0fb0a704853.zip" target="_blank" rel="noopener">下载</a></li><li><a href="https://www.h2os.com/download" target="_blank" rel="noopener">[一加官方] OnePlus 3T 氢OS(H2OS) 稳定版第7版</a> | <a href="http://download.h2os.com/OnePlus%203T/MP/OnePlus3THydrogen_28_OTA_051_all_1804292239_98839986dcaa492b.zip" target="_blank" rel="noopener">下载</a></li><li><a href="https://www.h2os.com/download" target="_blank" rel="noopener">[一加官方] OnePlus 3T 氢OS(H2OS) 公测版第11版</a> | <a href="http://download.h2os.com/OnePlus%203T/OPEN/OnePlus3THydrogen_28_OTA_048_all_1804241243_248d11ac3cd1408d.zip" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/development/rom-experience-rom-v1-0-t3522259" target="_blank" rel="noopener">ExperienceOS (OP3 only) [OOS 5.0.1 + OB35 Based]</a> | <a href="https://jamal2367.com/downloads/?dir=OnePlus%203/ExperienceOS" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3t/development/rom-theone3tos-v1-0-t3730932" target="_blank" rel="noopener">theOne3TOS - [OOS 5.0.1 + OB26 Based]</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=240431&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">OOS 下载</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=240431&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">Open Based 下载</a></li></ul><h2 id="其他-ROM"><a href="#其他-ROM" class="headerlink" title="其他 ROM"></a>其他 ROM</h2><ul><li><a href="https://forum.xda-developers.com/oneplus-3t/development#romList" target="_blank" rel="noopener">OnePlus 3T ROMs</a></li></ul><h2 id="救砖工具包（基于-Android-6-0）"><a href="#救砖工具包（基于-Android-6-0）" class="headerlink" title="救砖工具包（基于 Android 6.0）"></a>救砖工具包（基于 Android 6.0）</h2><ul><li><a href="http://www.shuame.com/faq/restore-tutorial/15302-3t-a3010--60.html" target="_blank" rel="noopener">一加3T (A3010/全网通) 官方恢复兼救砖 （安卓6.0）</a> | <a href="https://pan.baidu.com/s/1skAC79r" target="_blank" rel="noopener">下载地址一</a> | <a href="https://pan.baidu.com/s/1D35m7CUgXK2qDOQ6tFV-GA" target="_blank" rel="noopener">下载地址二</a></li></ul><h1 id="内核-Kernel"><a href="#内核-Kernel" class="headerlink" title="内核 Kernel"></a>内核 Kernel</h1><ul><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/kernel-caesium-kernel-op3-op3t-t3672090" target="_blank" rel="noopener">Caesium - CadaverousCherry</a> | <a href="https://github.com/MSF-Jarvis/oneplus3/releases/" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/derp-kernel-oxygenos-oreo-unified-3-18-t3691960" target="_blank" rel="noopener">Derp 4.0 (OOS)</a> | <a href="https://downloads.akhilnarang.me/kernel/oneplus3/Stable/" target="_blank" rel="noopener">下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3t/development/kernel-flash-kernel-r3-t3574681" target="_blank" rel="noopener">Flash</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=256253&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载(OOS)</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=256253&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载(Custom)</a></li><li><a href="https://forum.xda-developers.com/oneplus-3t/development/kernel-boeffla-kernel-xx-12-2016-t3520455" target="_blank" rel="noopener">Boeffla kernel 3.0 beta 5 (OOS)</a> | <a href="http://kernel.boeffla.de/oneplus3t/boeffla-kernel-oos/oos5xx_download/Test/" target="_blank" rel="noopener">OP3T 下载</a> | <a href="http://kernel.boeffla.de/oneplus3/boeffla-kernel-oos/oos5xx_download/Test/" target="_blank" rel="noopener">OP3 下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3t/development/kernel-boeffla-kernel-xx-12-2016-t3520455" target="_blank" rel="noopener">Boeffla kernel 3.0 beta 5 (LOS 15.1) </a> | <a href="http://kernel.boeffla.de/oneplus3t/boeffla-kernel-lineage/lineage15_download/Test/" target="_blank" rel="noopener">OP3T 下载</a> | <a href="http://kernel.boeffla.de/oneplus3/boeffla-kernel-lineage/lineage15_download/Test/" target="_blank" rel="noopener">OP3 下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/op3-3t-kernel-white-wolf-kernel-29-05-t3614601" target="_blank" rel="noopener">White Wolf (OOS)</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=233922&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">OP3T 下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/kernel-yarpiin-kernel-22-11-2016-t3524162" target="_blank" rel="noopener">White Wolf (Custom)</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=154993&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">OP3T 下载</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/kernel-holydragon-kernel-t3732974" target="_blank" rel="noopener">HolyDragon</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=213131&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载 (OOS/H2OS) </a> | <a href="https://androidfilehost.com/?w=files&amp;flid=249668&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener">下载 (Omni/AOSP)</a></li><li><a href="下载">MadysXtended [Android 8.1 Only]</a> | <a href="https://androidfilehost.com/?w=files&amp;flid=243002&amp;sort_by=date&amp;sort_dir=DESC" target="_blank" rel="noopener"></a></li><li><a href="https://forum.xda-developers.com/oneplus-3t/development/kernel-franco-kernel-r1-12nd-december-t3517519" target="_blank" rel="noopener">Franco Kernel</a> | 下载 (OOS) <a href="https://kernels.franco-lnx.net/OnePlus3T/8.0.0/anyKernel/" target="_blank" rel="noopener">OP3T</a> <a href="https://kernels.franco-lnx.net/OnePlus3/8.0.0/anyKernel/" target="_blank" rel="noopener">OP3</a> | 下载 (Custom) <a href="https://kernels.franco-lnx.net/OnePlus3T/8.1.0/anyKernel/" target="_blank" rel="noopener">OP3T</a> <a href="https://kernels.franco-lnx.net/OnePlus3/8.1.0/anyKernel/" target="_blank" rel="noopener">OP3</a></li></ul><h1 id="固件-Firmware"><a href="#固件-Firmware" class="headerlink" title="固件 Firmware"></a>固件 Firmware</h1><ul><li>OP3T | <a href="https://forum.xda-developers.com/oneplus-3t/how-to/firmware-beta-10-t3631166" target="_blank" rel="noopener">[OP3T][FIRMWARE+MODEM] Open Beta 26 - Oreo</a> | <a href="https://androidfilehost.com/?fid=745849072291697659" target="_blank" rel="noopener">下载 (OOS)</a> | <a href="https://androidfilehost.com/?fid=818070582850509980" target="_blank" rel="noopener">下载 (Open Beta)</a></li><li>OP3 | <a href="https://forum.xda-developers.com/oneplus-3t/how-to/firmware-beta-10-t3631166" target="_blank" rel="noopener">[FIRMWARE/MODEM] Collection - Flashable Zips!</a> | <a href="https://jamal2367.com/downloads/?dir=OnePlus%203/Firmware%20%2B%20Modems/Android%208.0.0/OxygenOS" target="_blank" rel="noopener">下载 (OOS)</a> | <a href="https://jamal2367.com/downloads/?dir=OnePlus%203/Firmware%20%2B%20Modems/Android%208.0.0/Open%20Beta" target="_blank" rel="noopener">下载 (Open Beta)</a></li></ul><h1 id="Recovery"><a href="#Recovery" class="headerlink" title="Recovery"></a>Recovery</h1><ul><li><a href="http://oxygenos.oneplus.net.s3.amazonaws.com/recovery_op3t.img" target="_blank" rel="noopener">[一加官方] Oxygen Recovery</a></li><li><a href="https://forum.xda-developers.com/oneplus-3/oneplus-3--3t-cross-device-development/recovery-official-twrp-touch-recovery-t3742894" target="_blank" rel="noopener">Official TWRP 3.2.1-0 (unified)</a> | <a href="https://twrp.me/oneplus/oneplusthree.html" target="_blank" rel="noopener">下载</a></li></ul><h1 id="ADB"><a href="#ADB" class="headerlink" title="ADB"></a>ADB</h1><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><h3 id="Windows-版"><a href="#Windows-版" class="headerlink" title="Windows 版"></a>Windows 版</h3><ul><li>官方下载：<a href="https://dl.google.com/android/repository/platform-tools-latest-windows.zip" target="_blank" rel="noopener">https://dl.google.com/android/repository/platform-tools-latest-windows.zip</a></li><li>网盘下载链接：<a href="http://pan.baidu.com/s/1eRG8gXs" target="_blank" rel="noopener">http://pan.baidu.com/s/1eRG8gXs</a> 密码：72ac</li></ul><h3 id="MacOS-版"><a href="#MacOS-版" class="headerlink" title="MacOS 版"></a>MacOS 版</h3><ul><li>官方下载：<a href="https://dl.google.com/android/repository/platform-tools-latest-darwin.zip" target="_blank" rel="noopener">https://dl.google.com/android/repository/platform-tools-latest-darwin.zip</a></li><li>网盘下载链接：<a href="http://pan.baidu.com/s/1pLQFvrt" target="_blank" rel="noopener">http://pan.baidu.com/s/1pLQFvrt</a> 密码：7qav</li></ul><h3 id="Linux-版"><a href="#Linux-版" class="headerlink" title="Linux 版"></a>Linux 版</h3><ul><li>官方下载：<a href="https://dl.google.com/android/repository/platform-tools-latest-linux.zip" target="_blank" rel="noopener">https://dl.google.com/android/repository/platform-tools-latest-linux.zip</a></li><li>网盘下载链接：<a href="http://pan.baidu.com/s/1nu8mvrF" target="_blank" rel="noopener">http://pan.baidu.com/s/1nu8mvrF</a> 密码：giug</li></ul><h2 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h2><ul><li><a href="https://www.xda-developers.com/install-adb-windows-macos-linux/" target="_blank" rel="noopener">How to Install ADB on Windows, macOS, and Linux</a></li></ul><h1 id="框架-Framework"><a href="#框架-Framework" class="headerlink" title="框架 Framework"></a>框架 Framework</h1><h2 id="Xposed"><a href="#Xposed" class="headerlink" title="Xposed"></a>Xposed</h2><h3 id="下载-1"><a href="#下载-1" class="headerlink" title="下载"></a>下载</h3><ul><li><a href="https://forum.xda-developers.com/showthread.php?t=3034811" target="_blank" rel="noopener">[zip] Xposed for Oreo</a> | <a href="https://dl-xda.xposed.info/framework/sdk26/arm64/" target="_blank" rel="noopener">SDK26 Android 8.0 下载</a> | <a href="https://dl-xda.xposed.info/framework/sdk27/arm64/" target="_blank" rel="noopener">SDK27 Android 8.1 下载</a></li><li><a href="https://dl-xda.xposed.info/framework/uninstaller/" target="_blank" rel="noopener">[zip] Xposed Uninstaller</a></li><li><a href="https://forum.xda-developers.com/attachment.php?attachmentid=4393082&amp;d=1516301692" target="_blank" rel="noopener">[apk] Xposed Installer</a></li><li><a href="https://forum.xda-developers.com/xposed/material-design-xposed-installer-t3137758" target="_blank" rel="noopener">[apk] Material Design Xposed Installer</a> | <a href="https://forum.xda-developers.com/devdb/project/?id=13191#downloads" target="_blank" rel="noopener">下载</a></li></ul><h3 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h3><ul><li><a href="https://www.zhihu.com/question/22063862" target="_blank" rel="noopener">Android 系统上的 Xposed 框架中都有哪些值得推荐的模块？</a></li></ul><h2 id="Magisk"><a href="#Magisk" class="headerlink" title="Magisk"></a>Magisk</h2><h3 id="下载-2"><a href="#下载-2" class="headerlink" title="下载"></a>下载</h3><ul><li><a href="https://github.com/topjohnwu/Magisk/releases/download/v16.0/Magisk-v16.0.zip" target="_blank" rel="noopener">[zip] Latest Magisk</a></li><li><a href="https://github.com/topjohnwu/Magisk/releases/download/v16.4/Magisk-uninstaller-20180429.zip" target="_blank" rel="noopener">[zip] Latest Uninstaller</a> (Support all versions)</li><li><a href="https://github.com/topjohnwu/MagiskManager/releases/download/v5.7.0/MagiskManager-v5.7.0.apk" target="_blank" rel="noopener">[apk] Latest Magisk Manager</a></li></ul><h3 id="模块-1"><a href="#模块-1" class="headerlink" title="模块"></a>模块</h3><ul><li><a href="http://www.oneplusbbs.com/thread-3302341-1-1.html" target="_blank" rel="noopener">[教程] (搬运XDA)magisk框架教程以及模块-xposed的替代品</a></li></ul><h1 id="软件-APP"><a href="#软件-APP" class="headerlink" title="软件 APP"></a>软件 APP</h1><h2 id="应用市场"><a href="#应用市场" class="headerlink" title="应用市场"></a>应用市场</h2><ul><li><a href="https://play.google.com/store" target="_blank" rel="noopener">Google Play</a></li><li><a href="https://www.coolapk.com/" target="_blank" rel="noopener">酷安</a></li></ul><h2 id="Shadowsocks"><a href="#Shadowsocks" class="headerlink" title="Shadowsocks"></a>Shadowsocks</h2><ul><li><a href="https://github.com/shadowsocks/shadowsocks-android/releases" target="_blank" rel="noopener">Github . shadowsocks/shadowsocks-android</a></li><li><a href="https://play.google.com/store/apps/details?id=com.github.shadowsocks" target="_blank" rel="noopener">Google Play . Shadowsocks</a></li></ul><h2 id="ShadowsocksR"><a href="#ShadowsocksR" class="headerlink" title="ShadowsocksR"></a>ShadowsocksR</h2><ul><li><a href="https://github.com/shadowsocksr-backup/shadowsocksr-android/releases" target="_blank" rel="noopener">Github . shadowsocksr-backup/shadowsocksr-android</a></li></ul><h2 id="GAPPS"><a href="#GAPPS" class="headerlink" title="GAPPS"></a>GAPPS</h2><ul><li><a href="http://opengapps.org/" target="_blank" rel="noopener">Open Gapps (8.0/8.1)</a></li></ul><h2 id="Pixel2Mod-Google-Camera"><a href="#Pixel2Mod-Google-Camera" class="headerlink" title="Pixel2Mod Google Camera"></a>Pixel2Mod Google Camera</h2><ul><li><a href="https://forum.xda-developers.com/oneplus-3/how-to/modded-google-camera-hdr-60fps-video-t3658552" target="_blank" rel="noopener">Pixel2Mod Google Camera</a></li></ul><h2 id="Google-Pixel-实时动态壁纸"><a href="#Google-Pixel-实时动态壁纸" class="headerlink" title="Google Pixel 实时动态壁纸"></a>Google Pixel 实时动态壁纸</h2><ul><li><a href="https://forum.xda-developers.com/android/apps-games/port-live-earth-wallpapers-t3481640" target="_blank" rel="noopener">[Google Pixel/2] Live Wallpapers</a></li></ul><h2 id="绿色守护"><a href="#绿色守护" class="headerlink" title="绿色守护"></a>绿色守护</h2><ul><li><a href="https://play.google.com/store/apps/details?id=com.oasisfeng.greenify&amp;hl=zh" target="_blank" rel="noopener">Google Play . 绿色守护 (Greenify)</a></li><li><a href="https://www.coolapk.com/apk/com.oasisfeng.greenify" target="_blank" rel="noopener">酷安 . Greenify绿色守护</a></li></ul><h3 id="教程-1"><a href="#教程-1" class="headerlink" title="教程"></a>教程</h3><p><a href="https://greenify.uservoice.com/knowledgebase/articles/749142" target="_blank" rel="noopener">How to grant permissions required by some features on non-root device?</a></p><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><p>Android 7.0+ 非 root 开启嗜睡模式授权命令（其他命令见教程）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb -d shell pm grant com.oasisfeng.greenify android.permission.WRITE_SECURE_SETTINGS</span><br></pre></td></tr></table></figure><h2 id="冰箱"><a href="#冰箱" class="headerlink" title="冰箱"></a>冰箱</h2><ul><li><a href="https://play.google.com/store/apps/details?id=com.catchingnow.icebox&amp;hl=zh" target="_blank" rel="noopener">Google Play . 冰箱 Ice Box —自动冻结应用</a></li><li><a href="https://www.coolapk.com/apk/com.catchingnow.icebox" target="_blank" rel="noopener">酷安 . 冰箱 Ice Box</a></li></ul><h3 id="教程-2"><a href="#教程-2" class="headerlink" title="教程"></a>教程</h3><p><a href="https://github.com/heruoxin/Ice-Box-Docs/blob/master/Device%20Owner%20%EF%BC%88%E5%85%8D%20root%EF%BC%89%E6%A8%A1%E5%BC%8F%E8%AE%BE%E7%BD%AE.md" target="_blank" rel="noopener">冰箱免 Root（设备管理员模式）使用配置方法</a></p><h3 id="命令-1"><a href="#命令-1" class="headerlink" title="命令"></a>命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell dpm set-device-owner com.catchingnow.icebox/.receiver.DPMReceiver</span><br></pre></td></tr></table></figure><h2 id="黑域"><a href="#黑域" class="headerlink" title="黑域"></a>黑域</h2><ul><li><a href="https://play.google.com/store/apps/details?id=me.piebridge.brevent&amp;hl=zh" target="_blank" rel="noopener">Google Play . 黑阈</a></li><li><a href="https://www.coolapk.com/apk/me.piebridge.brevent" target="_blank" rel="noopener">酷安 . 黑阈</a></li></ul><h3 id="命令-2"><a href="#命令-2" class="headerlink" title="命令"></a>命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb -d shell sh /data/data/me.piebridge.brevent/brevent.sh</span><br></pre></td></tr></table></figure><h1 id="教程博文"><a href="#教程博文" class="headerlink" title="教程博文"></a>教程博文</h1><ul><li><a href="https://forum.xda-developers.com/oneplus-3t/how-to/info-list-oreo-roms-kernels-available-3-t3688139" target="_blank" rel="noopener">[INFO] List of all Oreo roms/kernels/recovery for 3/3T (UPDATED : 2018-05-06)</a></li><li><a href="https://forums.oneplus.com/threads/guide-oneplus-3t-how-to-unlock-bootloader-flash-twrp-root-nandroid-efs-backup-and-more.475142/" target="_blank" rel="noopener">[GUIDE] OnePlus 3T: How to Unlock Bootloader | Flash TWRP | Root | Nandroid &amp; EFS Backup and More !!</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;一加 3T ROM、内核（Kernel）、固件（Firmware）、Recovery、框架（Framework）、软件（APP），以备茶余饭后手贱刷机之用。&lt;/p&gt;
&lt;h2 id=&quot;相关链接&quot;&gt;&lt;a href=&quot;#相关链接&quot; class=&quot;headerlink&quot; title=&quot;相关链接&quot;&gt;&lt;/a&gt;相关链接&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Github Repository： &lt;a href=&quot;https://github.com/huihut/awesome-oneplus-3t&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;huihut/awesome-oneplus-3t&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;之前的相关博文：&lt;a href=&quot;https://blog.huihut.com/2017/08/27/Oneplus3TBrushAndPlay/&quot;&gt;一加3T的刷机流程及玩机一些事&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="刷机" scheme="https://blog.huihut.com/tags/%E5%88%B7%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>Flutter beta 版尝鲜（在 Windows + Android Studio 与 MacOS + VS Code 的安装配置）</title>
    <link href="https://blog.huihut.com/2018/03/13/FlutterBetaTaste/"/>
    <id>https://blog.huihut.com/2018/03/13/FlutterBetaTaste/</id>
    <published>2018-03-13T11:06:43.000Z</published>
    <updated>2018-10-13T06:37:35.633Z</updated>
    
    <content type="html"><![CDATA[<p>Flutter 是一个 Google 发布的跨平台移动 UI 框架，使用 Dart 语言开发，可以构建高质量原生 iOS 、Android 以及 Fuchsia OS 应用，并且在排版、图标、滚动、点击等方面实现零差异。</p><p><a href="https://flutter.io/" target="_blank" rel="noopener">Flutter 官网</a></p><p>鉴于最近出了 beta 版，就来尝鲜一下吧。</p><p>本文有 Windows + Android Studio 与 MacOS + VS Code 的体验。</p><a id="more"></a><h2 id="Windows-Android-Studio"><a href="#Windows-Android-Studio" class="headerlink" title="Windows + Android Studio"></a>Windows + Android Studio</h2><h3 id="获取-Flutter-SDK"><a href="#获取-Flutter-SDK" class="headerlink" title="获取 Flutter SDK"></a>获取 Flutter SDK</h3><p>使用 <a href="https://git-scm.com/" target="_blank" rel="noopener">git</a> 克隆下来 Flutter SDK</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone -b beta https://github.com/flutter/flutter.git</span><br></pre></td></tr></table></figure><p>也可以使用中国的镜像，使用方法：<a href="https://github.com/flutter/flutter/wiki/Using-Flutter-in-China" target="_blank" rel="noopener">Using Flutter in China</a></p><p><img src="http://ojlsgreog.bkt.clouddn.com/GitCloneFlutter.png" alt="GitCloneFlutter"></p><h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><p>添加 <code>flutter\bin</code> 的完整路径到<code>用户变量</code> <code>Path</code>，如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\code\git\flutter\bin</span><br></pre></td></tr></table></figure><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><p>打开<code>cmd</code>或者<code>PowerShell</code>，安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flutter doctor</span><br></pre></td></tr></table></figure><p>安装过程可能持续比较久</p><p><img src="http://ojlsgreog.bkt.clouddn.com/flutterdoctor.png" alt="flutterdoctor"></p><h3 id="为-Android-Studio-安装-Flutter-插件"><a href="#为-Android-Studio-安装-Flutter-插件" class="headerlink" title="为 Android Studio 安装 Flutter 插件"></a>为 Android Studio 安装 Flutter 插件</h3><p><img src="http://ojlsgreog.bkt.clouddn.com/AndroidStudioInstallFlutter.png" alt="AndroidStudioInstallFlutter"></p><p>装好后重启 Android Studio</p><h3 id="创建-Flutter-APP"><a href="#创建-Flutter-APP" class="headerlink" title="创建 Flutter APP"></a>创建 Flutter APP</h3><ol><li>选择 <code>File</code> &gt; <code>New Flutter Project</code></li><li>选择 <code>Flutter application</code></li><li>输入应用名 <code>flutter_app</code>，输入 <code>Flutter SDK</code> 路径（如我的：<code>D:\code\git\flutter</code>）</li><li><code>Finish</code></li><li>等待创建</li></ol><p>创建好后，应用程序的代码在<code>lib/main.dart</code></p><h3 id="启动-Flutter-APP"><a href="#启动-Flutter-APP" class="headerlink" title="启动 Flutter APP"></a>启动 Flutter APP</h3><ol><li>选择设备</li><li><code>Run</code></li></ol><p><img src="http://ojlsgreog.bkt.clouddn.com/ASRunFlutterAPP.png" alt="ASRunFlutterAPP"></p><h3 id="尝试热重载"><a href="#尝试热重载" class="headerlink" title="尝试热重载"></a>尝试热重载</h3><p>把<code>lib/main.dart</code>里面的字符串</p><p><code>&#39;You have pushed the button this many times:&#39;</code></p><p>改成</p><p><code>&#39;Hahaha, You have clicked the button this many times:&#39;</code></p><p>不用停止模拟器，直接 <code>Save All（cmd-s/ ctrl-s）</code>，或者单击 <code>Hot Reload</code> 按钮（带有闪电图标的按钮）</p><p>就能看到模拟器中间那行字符串很快更新了。</p><p>嗯，体验还是蛮爽的！</p><h2 id="MacOS-VS-Code"><a href="#MacOS-VS-Code" class="headerlink" title="MacOS + VS Code"></a>MacOS + VS Code</h2><p>接下来看下在 MacOS 下的安装</p><h3 id="获取-Flutter-SDK-1"><a href="#获取-Flutter-SDK-1" class="headerlink" title="获取 Flutter SDK"></a>获取 Flutter SDK</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone -b beta https://github.com/flutter/flutter.git</span><br><span class="line">export PATH=`pwd`/flutter/bin:$PATH</span><br></pre></td></tr></table></figure><h3 id="配置环境变量-1"><a href="#配置环境变量-1" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><p>打开环境变量配置文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi $HOME/.bash_profile</span><br></pre></td></tr></table></figure><p>添加一行你的<code>flutter/bin</code>的绝对路径，如我的：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=/Users/xx/code/git/flutter/bin:$PATH</span><br></pre></td></tr></table></figure><p>刷新</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source $HOME/.bash_profile</span><br></pre></td></tr></table></figure><p>验证一下是否配置好</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo $PATH</span><br></pre></td></tr></table></figure><h3 id="安装依赖-1"><a href="#安装依赖-1" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flutter doctor</span><br></pre></td></tr></table></figure><h3 id="为-VS-Code-安装-Flutter-插件"><a href="#为-VS-Code-安装-Flutter-插件" class="headerlink" title="为 VS Code 安装 Flutter 插件"></a>为 VS Code 安装 Flutter 插件</h3><p>在扩展商店中搜索 <code>Dart Code</code> 下载安装</p><p><img src="http://ojlsgreog.bkt.clouddn.com/VSCodeInstallDartCode.jpg" alt=""></p><p>安装好后重新打开</p><p>点击 <code>查看</code> - <code>命令面板</code>，搜索 <code>Flutter: Run Flutter Doctor</code> </p><p>如果 VS Code 找不到 Flutter SDK 路径，就点击进行配置</p><p>配置好后重新 <code>Flutter: Run Flutter Doctor</code>，检查配置是否成功</p><h3 id="编译-iOS-需要-Xcode-9-0-0"><a href="#编译-iOS-需要-Xcode-9-0-0" class="headerlink" title="编译 iOS 需要 Xcode 9.0.0+"></a>编译 iOS 需要 Xcode 9.0.0+</h3><p>接下来再检查还需要安装什么</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flutter doctor</span><br></pre></td></tr></table></figure><p>然后突然发现。。。</p><p><img src="http://ojlsgreog.bkt.clouddn.com/MacFlutterDoctorRequiresXcode.jpg" alt="MacFlutterDoctorRequiresXcode"></p><p>要编译 iOS 应用需要 Xcode 9.0.0+ ！</p><p>可是官网明明说的是 Xcode 7.2+ ？打脸？？</p><p><img src="http://ojlsgreog.bkt.clouddn.com/FlutterOfficialSiteXcode.jpg" alt="FlutterOfficialSiteXcode"></p><p>对此，我特意把我的 Xcode 从 7.1 更新到 7.2，结果还是说需要 9.0.0+，看来是官网教程没更新了。</p><p><img src="http://ojlsgreog.bkt.clouddn.com/MacFlutterDoctorRequiresXcode9.0.jpg" alt="MacFlutterDoctorRequiresXcode9"></p><p>什么？你说为什么不更新到 Xcode 最新版？</p><p>这个……由于博主的是黑苹果，无法升级 MacOS，现在还是 OSX 10.10.5，最高支持的 Xcode 是 7.2.1</p><p>所以只好再编译 Android 应用了，下面也只讲构建 Android 的</p><p>这里附上有编译 iOS 的教程：<a href="http://blog.csdn.net/hekaiyou/article/details/52874796?locationNum=4&amp;fps=1" target="_blank" rel="noopener">Flutter基础—开发环境与入门</a></p><h3 id="创建并执行-Flutter-APP"><a href="#创建并执行-Flutter-APP" class="headerlink" title="创建并执行 Flutter APP"></a>创建并执行 Flutter APP</h3><p>在 VS Code 的终端（或其他终端）上跳转到要创建项目的路径，然后创建名为<code>flutter_app</code>的项目</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~/code/Android</span><br><span class="line">flutter create flutter_app</span><br><span class="line">cd flutter_app</span><br><span class="line">flutter run</span><br></pre></td></tr></table></figure><p>在 Windows 的时候使用的是模拟器，现在用真机体验一下</p><p><img src="http://ojlsgreog.bkt.clouddn.com/MacFlutterRun.jpg" alt="MacFlutterRun"></p><p>运行后，试着修改字符串</p><p><code>&#39;You have pushed the button this many times:&#39;</code></p><p>改成</p><p><code>&#39;yeah, You have pushed the button this many times:&#39;</code></p><p>保存，然后在终端按 <code>r</code> 热重载</p><ul><li><code>r</code>：热重载</li><li><code>R</code>：重启整个APP</li><li><code>h</code>：帮助</li><li><code>q</code>：退出APP  </li></ul><p>嗯，Cool。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Flutter 是一个 Google 发布的跨平台移动 UI 框架，使用 Dart 语言开发，可以构建高质量原生 iOS 、Android 以及 Fuchsia OS 应用，并且在排版、图标、滚动、点击等方面实现零差异。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://flutter.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Flutter 官网&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;鉴于最近出了 beta 版，就来尝鲜一下吧。&lt;/p&gt;
&lt;p&gt;本文有 Windows + Android Studio 与 MacOS + VS Code 的体验。&lt;/p&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="Flutter" scheme="https://blog.huihut.com/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>GitHub 弃用 TLS 1.0、1.1 导致 push 异常 SSL routines:SSL23_GET_SERVER_HELLO:tlsv1 alert protocol version</title>
    <link href="https://blog.huihut.com/2018/02/28/GitHubAbandonedTLS1.0_1.1/"/>
    <id>https://blog.huihut.com/2018/02/28/GitHubAbandonedTLS1.0_1.1/</id>
    <published>2018-02-28T11:13:09.000Z</published>
    <updated>2018-10-13T06:37:46.862Z</updated>
    
    <content type="html"><![CDATA[<h2 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h2><p>git push 到 Github 的时候出现异常：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fatal: unable to access &apos;https://github.com/huihut/interview.git/&apos;: error:1407742E:SSL routines:SSL23_GET_SERVER_HELLO:tlsv1 alert protocol version</span><br><span class="line">Pushing to https://github.com/huihut/interview.git</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>在 2018年2月22日19:00 UTC（太平洋标准时间上午11:00），GitHub 停止了对加密弱 TLS 1.0 和 1.1 协议的支持，并且仅支持与 TLS 1.2 协议的连接。</p><p>官方声明：</p><p><a href="https://githubengineering.com/crypto-removal-notice/" target="_blank" rel="noopener">Github . Weak cryptographic standards removal notice</a></p><p>因此，如果你的 git 连接方式仍然是 TLS 1.0 或 1.1，则会报错。</p><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p>①  查看你的 TLS 版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global --list</span><br></pre></td></tr></table></figure><p>②  如果仍然是 TLS 1.0 或 1.1，则下载更新 Git 最新版：<a href="https://git-scm.com/" target="_blank" rel="noopener">https://git-scm.com/</a></p><p>③  安装好最新版 Git 后，更新 TLS</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global --unset http.sslVersion</span><br><span class="line">git config --global --add http.sslVersion tlsv1.2</span><br></pre></td></tr></table></figure><p>④  现在则可以使用 TLS 1.2 传输，并解决了此问题</p><p>操作如下图：</p><p><img src="http://ojlsgreog.bkt.clouddn.com/gitconfighttp.sslVersion.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;报错&quot;&gt;&lt;a href=&quot;#报错&quot; class=&quot;headerlink&quot; title=&quot;报错&quot;&gt;&lt;/a&gt;报错&lt;/h2&gt;&lt;p&gt;git push 到 Github 的时候出现异常：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;fatal: unable to access &amp;apos;https://github.com/huihut/interview.git/&amp;apos;: error:1407742E:SSL routines:SSL23_GET_SERVER_HELLO:tlsv1 alert protocol version&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Pushing to https://github.com/huihut/interview.git&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="版本控制" scheme="https://blog.huihut.com/tags/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/"/>
    
  </entry>
  
  <entry>
    <title>一个可以模仿你的表情的语音聊天机器人 —— Facemoji 废萌（OpenCV+Dlib+Live2D+图灵机器人+讯飞IAT语音听写+讯飞TTS语音合成）</title>
    <link href="https://blog.huihut.com/2018/02/08/Facemoji1/"/>
    <id>https://blog.huihut.com/2018/02/08/Facemoji1/</id>
    <published>2018-02-07T16:11:00.000Z</published>
    <updated>2018-10-13T06:37:32.750Z</updated>
    
    <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>本文介绍一个可以模仿你的表情的语音聊天机器人 —— Facemoji 废萌</p><p>这是个 Unity 项目，其暂时有两个模块 ：</p><ul><li>【模块一】是实时人脸卡通化（FaceTracking），使用 <a href="https://enoxsoftware.com/opencvforunity/" target="_blank" rel="noopener">OpenCV</a> 和 <a href="https://enoxsoftware.com/dlibfacelandmarkdetector/" target="_blank" rel="noopener">Dlib</a> 检测面部表情，并实时转化为 <a href="http://sites.cybernoids.jp/cubism-sdk2_e/unity_2-1" target="_blank" rel="noopener">Live2D</a> 模型，然后可 <a href="https://github.com/Chman/Moments" target="_blank" rel="noopener">录制</a> 成 gif 图；</li><li>【模块二】是人工智能（AI）使用 <a href="http://www.tuling123.com/" target="_blank" rel="noopener">图灵机器人</a>、<a href="http://www.xfyun.cn/services/voicedictation" target="_blank" rel="noopener">讯飞IAT语音听写</a>、<a href="http://www.xfyun.cn/services/online_tts" target="_blank" rel="noopener">讯飞TTS语音合成</a> 进行语音聊天。</li></ul><a id="more"></a><h2 id="预览"><a href="#预览" class="headerlink" title="预览"></a>预览</h2><p><img src="http://ojlsgreog.bkt.clouddn.com/Facemoji%E6%95%88%E6%9E%9C%E5%9B%BE_cn.png" alt="Facemoji效果图_cn"></p><h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p>源码：<a href="https://github.com/huihut/Facemoji" target="_blank" rel="noopener">Github . huihut/Facemoji</a></p><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><ul><li><a href="https://www.coolapk.com/apk/192260" target="_blank" rel="noopener">酷安 . Facemoji 废萌</a></li><li><a href="https://play.google.com/store/apps/details?id=com.huihut.facemoji" target="_blank" rel="noopener">Google Play (需要梯子)</a></li><li><a href="https://github.com/huihut/Facemoji/releases" target="_blank" rel="noopener">Github . Facemoji/releases</a></li><li><a href="https://drive.google.com/open?id=1ofJMFIdzXCdYYO3qO5hvrTQPJUumgSY-" target="_blank" rel="noopener">Google云盘 . Facemoji/Platform</a></li><li><a href="https://pan.baidu.com/s/1U08B_wPY67Zh1RTwFhrihA" target="_blank" rel="noopener">Baidu网盘 . Facemoji/Platform</a></li></ul><h2 id="为什么叫废萌（Facemoji）"><a href="#为什么叫废萌（Facemoji）" class="headerlink" title="为什么叫废萌（Facemoji）"></a>为什么叫废萌（Facemoji）</h2><p>首先，为什么叫废萌（Facemoji）？…emmm…这个项目其实是由 Animoji 启发的，由于当时 Animoji 没有开放 api，所以想开发个跨平台（Unity）的类似的项目，就叫 Facemoji。</p><p>至于中文名废萌嘛？…emmm…总觉得她除了卖萌没什么作用，所以就叫废（Face）萌（Moji）了。</p><h2 id="制作"><a href="#制作" class="headerlink" title="制作"></a>制作</h2><ol><li><p>从 <a href="https://drive.google.com/open?id=1ofJMFIdzXCdYYO3qO5hvrTQPJUumgSY-" target="_blank" rel="noopener">Google云盘</a> 或者 <a href="https://pan.baidu.com/s/1U08B_wPY67Zh1RTwFhrihA" target="_blank" rel="noopener">Baidu网盘</a>下载<code>shape_predictor_68_face_landmarks.dat</code>（已训练好的人脸检测模型）和 <code>Facemoji_Plugins_Assets_1.5.0.unitypackage</code>（精简的 OpenCV, Dlib, Live2D 和 Iflytek 库）</p></li><li><p>克隆下源码：<code>git clone git@github.com:huihut/Facemoji.git</code></p></li><li><p>创建一个新的 Unity 项目，命名为 Facemoji</p></li><li><p>把 <code>Facemoji-master</code> 文件夹中的 <code>Assets</code> 和 <code>ProjectSettings</code> 替换 <code>Facemoji</code> 的同名文件夹</p></li><li><p>把 <code>shape_predictor_68_face_landmarks.dat</code> 复制到 <code>Facemoji/Assets/StreamingAssets/</code></p></li><li><p>导入 <code>Facemoji_Plugins_Assets_1.5.0.unitypackage</code>。导入后的文件结构如下：<br> <img src="http://ojlsgreog.bkt.clouddn.com/FacemojiDirectoryStructure1.5.0.png" alt="FacemojiDirectoryStructure1.5.0.png"></p></li><li><p>转换平台到 Android（其他平台未适配）</p></li><li><p>Build &amp; Run</p></li></ol><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="实时人脸卡通化（FaceTracking）"><a href="#实时人脸卡通化（FaceTracking）" class="headerlink" title="实时人脸卡通化（FaceTracking）"></a>实时人脸卡通化（FaceTracking）</h3><p>使用 OpenCV 和 Dlib 检测面部表情，并实时转化为 Live2D 模型；</p><p>她可以跟着你的头部表情动，试着摇头看看吧。</p><h3 id="录制-gif-图"><a href="#录制-gif-图" class="headerlink" title="录制 gif 图"></a>录制 gif 图</h3><p>点击顶部中间的录制键可以录制 3 秒的 gif；</p><p>录制状态为：Recording（准备录制）、PreProcessing（正在录制）、Paused（正在压缩成gif图）</p><p>生成的 gif 存储在 <code>Application.dataPath</code>，Android 平台的话在<br><code>/storage/emulated/0/Android/data/com.huihut.facemoji/files/</code></p><h3 id="语音和文字聊天（聊天机器人？-她说她是-AI，不是机器人！-hhhh…）"><a href="#语音和文字聊天（聊天机器人？-她说她是-AI，不是机器人！-hhhh…）" class="headerlink" title="语音和文字聊天（聊天机器人？ 她说她是 AI，不是机器人！ hhhh…）"></a>语音和文字聊天（<del>聊天机器人？</del> 她说她是 AI，不是机器人！ hhhh…）</h3><p>使用 <strong>图灵机器人</strong>、<strong>讯飞 IAT 语音听写</strong>、<strong>讯飞 TTS 语音合成</strong></p><p>她很智能（<del>zhizhang</del>），可以：</p><ul><li>聊天对话</li><li>生活百科</li><li>数学计算</li><li>故事大全</li><li>笑话大全</li><li>成语接龙</li><li>星座运势</li><li>天气查询</li><li>…</li></ul><p>但是由于她是个中国 AI（<del>机器人</del>），图灵机器人只支持中文，所以她只能进行中文聊天，和她讲英文她只会翻译。</p><p>不过她以后会学习英文的（<del>换个会讲英文的</del>）。</p><h2 id="Gif演示"><a href="#Gif演示" class="headerlink" title="Gif演示"></a>Gif演示</h2><p><img src="http://ojlsgreog.bkt.clouddn.com/GifCapture-201802072218435427.gif" alt="GifCapture-201802072218435427.gif">    </p><h2 id="异常问题"><a href="#异常问题" class="headerlink" title="异常问题"></a>异常问题</h2><h3 id="人不动时模型抖动问题（特别是眼睛眉毛）Facemoji-issues-1"><a href="#人不动时模型抖动问题（特别是眼睛眉毛）Facemoji-issues-1" class="headerlink" title="人不动时模型抖动问题（特别是眼睛眉毛）Facemoji/issues/1"></a>人不动时模型抖动问题（特别是眼睛眉毛）<a href="https://github.com/huihut/Facemoji/issues/1" target="_blank" rel="noopener">Facemoji/issues/1</a></h3><h4 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h4><ul><li>手/眼/眉等的轻微抖动</li><li>Dlib 检测到的每一帧人脸特征点的位置会有轻微差距</li></ul><h4 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h4><ul><li><p>调整模型参数</p><p>  如果人眼睛小的话，可以修改 <code>FaceTracking.cs</code> 中 <a href="https://github.com/huihut/Facemoji/blob/v1.4.1/Assets/Scripts/FaceTracking.cs#L294" target="_blank" rel="noopener">live2DModelUpdate</a> 方法，把睁开眼的区间改大一点，如下：</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// eye_open_L                               // 左眼</span><br><span class="line">float eyeOpen_L = getRaitoOfEyeOpen_L (points);</span><br><span class="line">if (eyeOpen_L &gt; 0.4f &amp;&amp; eyeOpen_L &lt; 1.0f)</span><br><span class="line">    eyeOpen_L = 1;                          // 睁开眼</span><br><span class="line">else if (eyeOpen_L &gt;= 1.0f)</span><br><span class="line">    eyeOpen_L = 2;                          // 睁大眼</span><br><span class="line">else if (eyeOpen_L &lt;= 0.4f)</span><br><span class="line">    eyeOpen_L = 0;                          // 闭上眼</span><br><span class="line">live2DModel.PARAM_EYE_L_OPEN = eyeOpen_L;</span><br></pre></td></tr></table></figure><ul><li>考虑使用卡尔曼滤波器或者其他滤波器过滤（未尝试）</li></ul><h2 id="修改说明"><a href="#修改说明" class="headerlink" title="修改说明"></a>修改说明</h2><blockquote><p>2018年03月23日因项目更新 v1.5.0 版本而对此博文做了修改。因博文内容不常改动，项目部署、文档等以Github为准。</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概述&quot; class=&quot;headerlink&quot; title=&quot;概述&quot;&gt;&lt;/a&gt;概述&lt;/h2&gt;&lt;p&gt;本文介绍一个可以模仿你的表情的语音聊天机器人 —— Facemoji 废萌&lt;/p&gt;
&lt;p&gt;这是个 Unity 项目，其暂时有两个模块 ：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;【模块一】是实时人脸卡通化（FaceTracking），使用 &lt;a href=&quot;https://enoxsoftware.com/opencvforunity/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;OpenCV&lt;/a&gt; 和 &lt;a href=&quot;https://enoxsoftware.com/dlibfacelandmarkdetector/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Dlib&lt;/a&gt; 检测面部表情，并实时转化为 &lt;a href=&quot;http://sites.cybernoids.jp/cubism-sdk2_e/unity_2-1&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Live2D&lt;/a&gt; 模型，然后可 &lt;a href=&quot;https://github.com/Chman/Moments&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;录制&lt;/a&gt; 成 gif 图；&lt;/li&gt;
&lt;li&gt;【模块二】是人工智能（AI）使用 &lt;a href=&quot;http://www.tuling123.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;图灵机器人&lt;/a&gt;、&lt;a href=&quot;http://www.xfyun.cn/services/voicedictation&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;讯飞IAT语音听写&lt;/a&gt;、&lt;a href=&quot;http://www.xfyun.cn/services/online_tts&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;讯飞TTS语音合成&lt;/a&gt; 进行语音聊天。&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="Unity" scheme="https://blog.huihut.com/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Qt的QVaiant中使用非QMetaType类型缺少Q_DECLARE_METATYPE宏定义错误</title>
    <link href="https://blog.huihut.com/2017/12/05/QVaiantQ_DECLARE_METATYPE/"/>
    <id>https://blog.huihut.com/2017/12/05/QVaiantQ_DECLARE_METATYPE/</id>
    <published>2017-12-05T10:08:47.000Z</published>
    <updated>2018-10-13T06:38:10.765Z</updated>
    
    <content type="html"><![CDATA[<h2 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">E:\Qt\Qt5.9.3\5.9.3\mingw53_32\include\QtCore\qglobal.h:738: error: static assertion failed: Type is not registered, please use the Q_DECLARE_METATYPE macro to make it known to Qt&apos;s meta-object system</span><br><span class="line"> #define Q_STATIC_ASSERT_X(Condition, Message) static_assert(bool(Condition), Message)</span><br><span class="line">                                               ^</span><br></pre></td></tr></table></figure><a id="more"></a><p><img src="http://ojlsgreog.bkt.clouddn.com/Q_DECLARE_METATYPE.png" alt=""></p><h2 id="报错代码"><a href="#报错代码" class="headerlink" title="报错代码"></a>报错代码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const QCameraInfo &amp;cameraInfo</span><br><span class="line">...</span><br><span class="line">QVariant::fromValue(cameraInfo)</span><br></pre></td></tr></table></figure><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>QVaiant 不能识别自定义类型和其他非 QMetaType 内置类型， 而 QCameraInfo 是非 QMetaType 内置类型，因此使用 <code>QVariant::fromValue(cameraInfo)</code> 之前，需要使用 <code>Q_DECLARE_METATYPE</code> 宏对 QCameraInfo 进行声明。</p><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p>在代码中加个宏定义：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Q_DECLARE_METATYPE(QCameraInfo)</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>Q_DECLARE_METATYPE<ul><li>如果要使自定义类型或其他非 QMetaType 内置类型在 QVaiant 中使用，必须使用该宏</li><li>该类型必须有公有的 构造、析构、复制构造 函数</li></ul></li><li>qRegisterMetaType 必须使用该函数的两种情况<ul><li>如果非 QMetaType 内置类型要在 Qt 的属性系统中使用</li><li>如果非 QMetaType 内置类型要在 queued 信号与槽 中使用</li></ul></li></ul><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="http://blog.sina.com.cn/s/blog_640531380100yfei.html" target="_blank" rel="noopener">Q_DECLARE_METATYPE与qRegisterMetaType学习</a></li><li><a href="https://stackoverflow.com/questions/34278017/how-to-use-qvariantfromvalue-with-qstring" target="_blank" rel="noopener">How to use QVariant::fromValue with QString?</a></li><li><a href="http://doc.qt.io/qt-5/qmetatype.html#Q_DECLARE_METATYPE" target="_blank" rel="noopener">QMetaType Class - Q_DECLARE_METATYPE(Type)</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;报错&quot;&gt;&lt;a href=&quot;#报错&quot; class=&quot;headerlink&quot; title=&quot;报错&quot;&gt;&lt;/a&gt;报错&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;E:\Qt\Qt5.9.3\5.9.3\mingw53_32\include\QtCore\qglobal.h:738: error: static assertion failed: Type is not registered, please use the Q_DECLARE_METATYPE macro to make it known to Qt&amp;apos;s meta-object system&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; #define Q_STATIC_ASSERT_X(Condition, Message) static_assert(bool(Condition), Message)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                               ^&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="QT" scheme="https://blog.huihut.com/tags/QT/"/>
    
  </entry>
  
  <entry>
    <title>OpenCV使用CMake和MinGW的编译安装及其在Qt配置运行</title>
    <link href="https://blog.huihut.com/2017/12/03/CompiledOpenCVRunInQt/"/>
    <id>https://blog.huihut.com/2017/12/03/CompiledOpenCVRunInQt/</id>
    <published>2017-12-03T07:27:22.000Z</published>
    <updated>2018-10-13T06:37:24.724Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本篇博文是使用 32 位的 MinGW 在 Windows 下编译 OpenCV 生成 32 位的 dll。</p><p>关于使用 64 位的 MinGW 编译 OpenCV 生成 64 位的 dll，见：<a href="https://blog.huihut.com/2018/07/31/CompiledOpenCVWithMinGW64/">OpenCV使用CMake和MinGW-w64的编译安装</a></p><h2 id="编译好的-OpenCV（MinGW-版）："><a href="#编译好的-OpenCV（MinGW-版）：" class="headerlink" title="编译好的 OpenCV（MinGW 版）："></a>编译好的 OpenCV（MinGW 版）：</h2><p><a href="https://github.com/huihut/OpenCV-MinGW-Build" target="_blank" rel="noopener">Github . huihut/OpenCV-MinGW-Build</a></p><a id="more"></a><h2 id="软件环境"><a href="#软件环境" class="headerlink" title="软件环境"></a>软件环境</h2><ul><li>Windows-10-64bit</li><li><a href="https://download.qt.io/archive/qt/" target="_blank" rel="noopener">Qt-5.9.3</a></li><li><a href="https://sourceforge.net/projects/mingw/" target="_blank" rel="noopener">MinGW-5.3.0-32bit</a></li><li><a href="https://cmake.org/download/" target="_blank" rel="noopener">CMake-3.9.2</a></li><li><a href="https://opencv.org/releases.html" target="_blank" rel="noopener">OpenCV-3.3.1 / 3.4.1(适用)</a></li></ul><h2 id="OpenCV-的-MSVC-版及-MinGW-版"><a href="#OpenCV-的-MSVC-版及-MinGW-版" class="headerlink" title="OpenCV 的 MSVC 版及 MinGW 版"></a>OpenCV 的 MSVC 版及 MinGW 版</h2><h3 id="MSVC-版"><a href="#MSVC-版" class="headerlink" title="MSVC 版"></a>MSVC 版</h3><p>下载的 OpenCV 文件夹会有：</p><ul><li>build （已编译好的库）</li><li>sources （源码）</li></ul><p>使用 MSVC 的话，直接在</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">build/x64/vc14</span><br></pre></td></tr></table></figure><p>里面就有了，配置好路径就可以使用。</p><h3 id="MinGW-版"><a href="#MinGW-版" class="headerlink" title="MinGW 版"></a>MinGW 版</h3><p>OpenCV 没有为我们编译好 MinGW 版，所以我们只能自己编译，下面就是介绍 MinGW 版的编译流程。</p><p>也可以直接下载使用我编译好了的 OpenCV （在上文）。</p><h2 id="安装及配置-Qt、MinGW、CMake"><a href="#安装及配置-Qt、MinGW、CMake" class="headerlink" title="安装及配置 Qt、MinGW、CMake"></a>安装及配置 Qt、MinGW、CMake</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>CMake 自行安装，Qt 和 MinGW 可以直接使用<code>qt-opensource-windows-x86-5.9.3.exe</code> 安装包安装，注意选择安装的<code>组件(components)</code>的时候勾选 <code>MinGW</code> :</p><ul><li>Qt-Qt5.9-MingGW 5.3.0 32 bit</li><li>Qt-Tools-MinGW 5.3.0</li></ul><h3 id="配置-Qt、MinGW"><a href="#配置-Qt、MinGW" class="headerlink" title="配置 Qt、MinGW"></a>配置 Qt、MinGW</h3><p>安装好后打开QtCreator，在<code>工具</code>-<code>选项</code>-<code>构建和运行</code>-<code>构建套件</code>，选中<code>Desktop Qt 5.9.3 MinGW 32bit</code>，设为默认，OK。</p><h2 id="添加-MinGW-到环境变量"><a href="#添加-MinGW-到环境变量" class="headerlink" title="添加 MinGW 到环境变量"></a>添加 MinGW 到环境变量</h2><p>为系统变量 <code>Path</code> 添加 <code>E:\Qt\Qt5.9.3\Tools\mingw530_32\bin</code></p><h2 id="使用-CMake-生成-OpenCV-的-Makefile"><a href="#使用-CMake-生成-OpenCV-的-Makefile" class="headerlink" title="使用 CMake 生成 OpenCV 的 Makefile"></a>使用 CMake 生成 OpenCV 的 Makefile</h2><p>打开 cmake-gui，设置源码和生成路径：</p><ul><li>Where is the source code: E:/OpenCV_3.3.1/opencv/sources</li><li>Where to build the binaries: E:/OpenCV_3.3.1/opencv-build</li></ul><p>点击 Configure，设置编译器</p><ul><li>Specify the generator for this project: MinGW Makefiles</li><li>Specify native compilers</li><li>Next</li><li>Compilers C: E:\Qt\Qt5.9.3\Tools\mingw530_32\bin\gcc.exe</li><li>Compilers C++: E:\Qt\Qt5.9.3\Tools\mingw530_32\bin\g++.exe</li><li>Finish</li></ul><p>编译配置：</p><ul><li>勾选 <code>WITH_QT</code></li><li>勾选 <code>WITH_OPENGL</code></li></ul><p>点击 Configure，再次配置：</p><ul><li>不勾选 <code>WITH_IPP</code></li><li>设置 <code>QT_MAKE_EXECUTABLE</code> 为 <code>E:\Qt\Qt5.9.3\5.9.3\mingw53_32\bin\qmake.exe</code></li><li>设置 <code>Qt5Concurrent_DIR</code> 为 <code>E:\Qt\Qt5.9.3\5.9.3\mingw53_32\lib\cmake\Qt5Concurrent</code></li><li>设置 <code>Qt5Core_DIR</code> 为 <code>E:\Qt\Qt5.9.3\5.9.3\mingw53_32\lib\cmake\Qt5Core</code></li><li>设置 <code>Qt5Gui_DIR</code> 为 <code>E:\Qt\Qt5.9.3\5.9.3\mingw53_32\lib\cmake\Qt5Gui</code></li><li>设置 <code>Qt5Test_DIR</code> 为 <code>E:\Qt\Qt5.9.3\5.9.3\mingw53_32\lib\cmake\Qt5Test</code></li><li>设置 <code>Qt5Widgets_DIR</code> 为 <code>E:\Qt\Qt5.9.3\5.9.3\mingw53_32\lib\cmake\Qt5Widgets</code></li><li>设置 <code>Qt5OpenGL_DIR</code> 为 <code>E:\Qt\Qt5.9.3\5.9.3\mingw53_32\lib\cmake\Qt5OpenGL</code></li><li>设置 <code>CMAKE_BUILD_TYPE</code> 为 <code>Release</code> 或者 <code>RelWithDebInfo</code></li></ul><p>点击 Generate 生成 Makefile</p><p><img src="http://ojlsgreog.bkt.clouddn.com/OpenCVCMakeGenerate.png" alt="OpenCVCMakeGenerate"></p><h2 id="编译-OpenCV"><a href="#编译-OpenCV" class="headerlink" title="编译 OpenCV"></a>编译 OpenCV</h2><p>打开终端进行编译：（<code>-j</code> 是使用 <code>8</code> 个线程进行编译，请根据你的计算机配置合理设置线程数）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">E:</span><br><span class="line">cd E:\OpenCV_3.3.1\opencv-build</span><br><span class="line">mingw32-make -j 8</span><br><span class="line">mingw32-make install</span><br></pre></td></tr></table></figure><p>如果 <code>mingw32-make -j 8</code> 遇到错误，请看下面的  <strong>编译 OpenCV 常见错误</strong>，否则执行 <code>mingw32-make install</code>，完成安装。</p><h2 id="编译-OpenCV-常见错误"><a href="#编译-OpenCV-常见错误" class="headerlink" title="编译 OpenCV 常见错误"></a>编译 OpenCV 常见错误</h2><h3 id="0-多线程编译错误信息不明确"><a href="#0-多线程编译错误信息不明确" class="headerlink" title="0. 多线程编译错误信息不明确"></a>0. 多线程编译错误信息不明确</h3><h4 id="表现"><a href="#表现" class="headerlink" title="表现"></a>表现</h4><p>如果使用了多线程编译，导致错误，但是错误信息不明确，如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Makefile:161: recipe for target &apos;all&apos; failed</span><br><span class="line">mingw32-make: *** [all] Error 2</span><br></pre></td></tr></table></figure><p><img src="http://ojlsgreog.bkt.clouddn.com/MakeOpenCV_cap_dshow.png" alt="MakeOpenCV_cap_dshow"></p><h4 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h4><p>使用单线程编译：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mingw32-make</span><br></pre></td></tr></table></figure><p>以查看详细的错误提示，再根据具体情况解决。</p><h3 id="1-RC-错误"><a href="#1-RC-错误" class="headerlink" title="1. RC 错误"></a>1. RC 错误</h3><h4 id="表现-1"><a href="#表现-1" class="headerlink" title="表现"></a>表现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">... windres.exe: unknown option -- W ...</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FORMAT is one of rc, res, or coff, and is deduced from the file name</span><br><span class="line">extension if not specified.  A single file name is an input file.</span><br><span class="line">No input-file is stdin, default rc.  No output-file is stdout, default rc.</span><br></pre></td></tr></table></figure><p><img src="http://ojlsgreog.bkt.clouddn.com/MakeOpenCVRCError.png" alt="MakeOpenCVRCError"></p><h4 id="解决-1"><a href="#解决-1" class="headerlink" title="解决"></a>解决</h4><p>在 cmake-gui 编译配置中：</p><ul><li>不勾选 <code>ENABLE_PRECOMPILED_HEADERS</code></li></ul><p>然后重新<code>Configure</code>-<code>Generate</code>-<code>mingw32-make</code></p><h3 id="2-sprintf-instead-use-StringCbPrintfA-or-StringCchPrintfA-错误"><a href="#2-sprintf-instead-use-StringCbPrintfA-or-StringCchPrintfA-错误" class="headerlink" title="2. sprintf_instead_use_StringCbPrintfA_or_StringCchPrintfA 错误"></a>2. sprintf_instead_use_StringCbPrintfA_or_StringCchPrintfA 错误</h3><h4 id="表现-2"><a href="#表现-2" class="headerlink" title="表现"></a>表现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">...opencv/sources/modules/videoio/src/cap_dshow.cpp...</span><br><span class="line">... &apos;sprintf_instead_use_StringCbPrintfA_or_StringCchPrintfA&apos; was not declared in this scope ...</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Makefile:161: recipe for target &apos;all&apos; failed</span><br><span class="line">mingw32-make: *** [all] Error 2</span><br></pre></td></tr></table></figure><p><img src="http://ojlsgreog.bkt.clouddn.com/MakeOpenCV_cap_dshow.png" alt="MakeOpenCV_cap_dshow"></p><h4 id="解决-2"><a href="#解决-2" class="headerlink" title="解决"></a>解决</h4><p>修改<code>E:\OpenCV_3.3.1\opencv\sources\modules\videoio\src\cap_dshow.cpp</code>文件，在<code>#include &quot;DShow.h&quot;</code>这行的上面加一行<code>#define NO_DSHOW_STRSAFE</code>，如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#define NO_DSHOW_STRSAFE</span><br><span class="line">#include &quot;DShow.h&quot;</span><br></pre></td></tr></table></figure><p>然后重新<code>Configure</code>-<code>Generate</code>-<code>mingw32-make</code></p><h3 id="3-identifier-‘nullptr’-is-a-keyword-in-C-11-错误【2018年3月2日编译OpenCV-3-4-1时遇到并解决】"><a href="#3-identifier-‘nullptr’-is-a-keyword-in-C-11-错误【2018年3月2日编译OpenCV-3-4-1时遇到并解决】" class="headerlink" title="3. identifier ‘nullptr’ is a keyword in C++11 错误【2018年3月2日编译OpenCV 3.4.1时遇到并解决】"></a>3. identifier ‘nullptr’ is a keyword in C++11 错误【2018年3月2日编译OpenCV 3.4.1时遇到并解决】</h3><h4 id="表现-3"><a href="#表现-3" class="headerlink" title="表现"></a>表现</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">D:\opencv-3.4.1\opencv-3.4.1\3rdparty\protobuf\src\google\protobuf\stubs\io_win32.cc:94:3: warning: identifier &apos;nullptr&apos; is a keyword in C++11 [-Wc++0x-compat]</span><br><span class="line">   return s == nullptr || *s == 0;</span><br><span class="line">   ^</span><br><span class="line">D:\opencv-3.4.1\opencv-3.4.1\3rdparty\protobuf\src\google\protobuf\stubs\io_win32.cc: In function &apos;bool google::protobuf::internal::win32::&#123;anonymous&#125;::null_or_empty(const char_type*)&apos;:</span><br><span class="line">D:\opencv-3.4.1\opencv-3.4.1\3rdparty\protobuf\src\google\protobuf\stubs\io_win32.cc:94:15: error: &apos;nullptr&apos; was not declared in this scope</span><br><span class="line">   return s == nullptr || *s == 0;</span><br><span class="line">               ^</span><br><span class="line">3rdparty\protobuf\CMakeFiles\libprotobuf.dir\build.make:412: recipe for target &apos;3rdparty/protobuf/CMakeFiles/libprotobuf.dir/src/google/protobuf/stubs/io_win32.cc.obj&apos; failed</span><br><span class="line">mingw32-make[2]: *** [3rdparty/protobuf/CMakeFiles/libprotobuf.dir/src/google/protobuf/stubs/io_win32.cc.obj] Error 1</span><br><span class="line">CMakeFiles\Makefile2:710: recipe for target &apos;3rdparty/protobuf/CMakeFiles/libprotobuf.dir/all&apos; failed</span><br><span class="line">mingw32-make[1]: *** [3rdparty/protobuf/CMakeFiles/libprotobuf.dir/all] Error 2</span><br><span class="line">Makefile:161: recipe for target &apos;all&apos; failed</span><br><span class="line">mingw32-make: *** [all] Error 2</span><br></pre></td></tr></table></figure><p><img src="http://ojlsgreog.bkt.clouddn.com/MakeOpenCV_nullptr_Error.png" alt="MakeOpenCV_nullptr_Error"></p><h4 id="解决-3"><a href="#解决-3" class="headerlink" title="解决"></a>解决</h4><p>在 cmake-gui 编译配置中：</p><ul><li>勾选 <code>ENABLE_CXX11</code></li></ul><p>然后重新<code>Configure</code>-<code>Generate</code>-<code>mingw32-make</code></p><h2 id="添加-OpenCV-编译的库到环境变量"><a href="#添加-OpenCV-编译的库到环境变量" class="headerlink" title="添加 OpenCV 编译的库到环境变量"></a>添加 OpenCV 编译的库到环境变量</h2><ul><li>为系统变量 <code>Path</code> 添加 <code>E:\OpenCV_3.3.1\opencv-build\install\x86\mingw\bin</code></li></ul><h2 id="新建-OpenCV-的-Qt-项目"><a href="#新建-OpenCV-的-Qt-项目" class="headerlink" title="新建 OpenCV 的 Qt 项目"></a>新建 OpenCV 的 Qt 项目</h2><p>在 <code>.pro</code> 文件里面添加：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">win32 &#123;</span><br><span class="line">INCLUDEPATH += E:\OpenCV_3.3.1\opencv-build\install\include</span><br><span class="line">LIBS += E:\OpenCV_3.3.1\opencv-build\install\x86\mingw\bin\libopencv_*.dll</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>或者：（区分 debug 和 release 是因为 OpenCV 对其两者有不同的库，你需要把路径改为你自己的，我编译 MinGW 的 OpenCV 只有 release 库）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">win32 &#123;</span><br><span class="line">INCLUDEPATH += E:\OpenCV_3.3.1\opencv-build\install\include</span><br><span class="line">CONFIG(debug, debug|release): &#123;</span><br><span class="line">LIBS += E:\OpenCV_3.3.1\opencv-build\install\x86\mingw\bin\libopencv_*d.dll</span><br><span class="line">&#125; else:CONFIG(release, debug|release): &#123;</span><br><span class="line">LIBS += -LE:\OpenCV_3.3.1\opencv-build\install\x86\mingw\bin \</span><br><span class="line">    -llibopencv_core331 \</span><br><span class="line">    -llibopencv_highgui331 \</span><br><span class="line">    -llibopencv_imgcodecs331 \</span><br><span class="line">    -llibopencv_imgproc331 \</span><br><span class="line">    -llibopencv_features2d331 \</span><br><span class="line">    -llibopencv_calib3d331</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="http://ojlsgreog.bkt.clouddn.com/OpenCVMinGWBin.png" alt="OpenCVMinGWBin"></p><p>然后在 MainWindow 中如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;mainwindow.h&quot;</span><br><span class="line">#include &quot;ui_mainwindow.h&quot;</span><br><span class="line"></span><br><span class="line">#include &lt;opencv2/core/core.hpp&gt;</span><br><span class="line">#include &lt;opencv2/highgui/highgui.hpp&gt;</span><br><span class="line"></span><br><span class="line">MainWindow::MainWindow(QWidget *parent) :</span><br><span class="line">    QMainWindow(parent),</span><br><span class="line">    ui(new Ui::MainWindow)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;setupUi(this);</span><br><span class="line"></span><br><span class="line">    // read an image</span><br><span class="line">    cv::Mat image = cv::imread(&quot;E:/Pictures/H_white.png&quot;, 1);</span><br><span class="line">    // create image window named &quot;My Image&quot;</span><br><span class="line">    cv::namedWindow(&quot;My Image&quot;);</span><br><span class="line">    // show the image on window</span><br><span class="line">    cv::imshow(&quot;My Image&quot;, image);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainWindow::~MainWindow()</span><br><span class="line">&#123;</span><br><span class="line">    delete ui;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后运行起来了，效果如图：</p><p><img src="http://ojlsgreog.bkt.clouddn.com/OpenCVQtDemo.png" alt="OpenCVQtDemo"></p><h2 id="官方教程"><a href="#官方教程" class="headerlink" title="官方教程"></a>官方教程</h2><ul><li><a href="https://wiki.qt.io/How_to_setup_Qt_and_openCV_on_Windows" target="_blank" rel="noopener">How to setup Qt and openCV on Windows</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;本篇博文是使用 32 位的 MinGW 在 Windows 下编译 OpenCV 生成 32 位的 dll。&lt;/p&gt;
&lt;p&gt;关于使用 64 位的 MinGW 编译 OpenCV 生成 64 位的 dll，见：&lt;a href=&quot;https://blog.huihut.com/2018/07/31/CompiledOpenCVWithMinGW64/&quot;&gt;OpenCV使用CMake和MinGW-w64的编译安装&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;编译好的-OpenCV（MinGW-版）：&quot;&gt;&lt;a href=&quot;#编译好的-OpenCV（MinGW-版）：&quot; class=&quot;headerlink&quot; title=&quot;编译好的 OpenCV（MinGW 版）：&quot;&gt;&lt;/a&gt;编译好的 OpenCV（MinGW 版）：&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/huihut/OpenCV-MinGW-Build&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Github . huihut/OpenCV-MinGW-Build&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="链接装载库" scheme="https://blog.huihut.com/tags/%E9%93%BE%E6%8E%A5%E8%A3%85%E8%BD%BD%E5%BA%93/"/>
    
      <category term="QT" scheme="https://blog.huihut.com/tags/QT/"/>
    
  </entry>
  
  <entry>
    <title>使用MFC的CDC类绘制三维坐标系及球面函数</title>
    <link href="https://blog.huihut.com/2017/10/13/GraphicsExercise3D/"/>
    <id>https://blog.huihut.com/2017/10/13/GraphicsExercise3D/</id>
    <published>2017-10-12T16:57:52.000Z</published>
    <updated>2018-10-13T06:37:52.486Z</updated>
    
    <content type="html"><![CDATA[<h2 id="系列链接"><a href="#系列链接" class="headerlink" title="系列链接"></a>系列链接</h2><ul><li><p><a href="https://blog.huihut.com/2017/10/13/GraphicsExercise2D/">使用MFC的CDC类绘制二维坐标系及正余弦函数</a> / <a href="https://github.com/huihut/GraphicsExercise2D" target="_blank" rel="noopener">源码</a></p></li><li><p><a href="https://blog.huihut.com/2017/10/13/GraphicsExercise3D/">使用MFC的CDC类绘制三维坐标系及球面函数</a> / <a href="https://github.com/huihut/GraphicsExercise3D" target="_blank" rel="noopener">源码</a></p></li></ul><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>本文使用MFC的CDC类绘制三维坐标系及球面函数。首先计算推导出三维坐标在二维平面显示的坐标变换方程（使用斜二测视图），使用球面的参数方程，然后定义图形缩放比例规模、坐标轴位移，变换坐标系和规模等，最后绘制坐标轴及球面函数。</p><p>如果对绘制二维坐标系还不太熟悉可以先看上面系列链接的：<a href="https://blog.huihut.com/2017/10/13/GraphicsExercise2D/">使用MFC的CDC类绘制二维坐标系及正余弦函数</a>，本文对二维绘制及绘制函数部分不再赘述。因为二维坐标系的博文已经分模块讲解地比较清楚了，而与三维坐标系的基本思路相同，所以本文大部分直接使用注释讲解。</p><a id="more"></a><h2 id="三维转二维的推导"><a href="#三维转二维的推导" class="headerlink" title="三维转二维的推导"></a>三维转二维的推导</h2><p><img src="http://ojlsgreog.bkt.clouddn.com/Transform3Dto2D.png" alt="Transform3Dto2D"></p><p>上图可知，只要使用<code>Transform3Dto2D()</code>函数，即可方便的把三维坐标转化为二维坐标（斜二测视图）。</p><h2 id="球面参数方程"><a href="#球面参数方程" class="headerlink" title="球面参数方程"></a>球面参数方程</h2><p>在三维空间直角坐标系中，以原点为球心、半径为 <code>r</code> 的球面的方程为 <code>x^2 + y^2 + z^2 = r^2</code>，其参数方程为</p><p><img src="http://ojlsgreog.bkt.clouddn.com/SphericalParameterEquation.png" alt="SphericalParameterEquation"></p><h2 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h2><p><code>Visual Studio</code>- <code>新建项目</code> - <code>MFC应用程序</code> - 命名为<code>GraphicsExercise3D</code> - <code>确定</code> - <code>下一步</code> - 应用程序类型选择<code>单个文档</code> - <code>完成</code></p><h2 id="GraphicsExercise3DView-h"><a href="#GraphicsExercise3DView-h" class="headerlink" title="GraphicsExercise3DView.h"></a>GraphicsExercise3DView.h</h2><p>在<code>GraphicsExercise3DView.h</code>添加以下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 操作</span><br><span class="line">public:</span><br><span class="line">void SetScale(int scale);</span><br><span class="line">void SetTransformOrigin(float transformOriginX, float transformOriginY);</span><br><span class="line">void SetPlotSphere(float radius, float stepPhi, float stepTheta);</span><br><span class="line">  void SetSlantRadian(float slant);</span><br><span class="line"></span><br><span class="line">float TransformScale(float num);</span><br><span class="line">float TransformOriginX(float x);</span><br><span class="line">float TransformOriginY(float y);</span><br><span class="line">float TransformOriginScaleX(float x);</span><br><span class="line">float TransformOriginScaleY(float y);</span><br><span class="line">void Transform3Dto2D(float &amp;x, float &amp;y, float z);</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">    int scale;</span><br><span class="line">    float radius, stepPhi, stepTheta, slant, transformOriginX, transformOriginY;</span><br></pre></td></tr></table></figure><h2 id="GraphicsExercise3DView-cpp"><a href="#GraphicsExercise3DView-cpp" class="headerlink" title="GraphicsExercise3DView.cpp"></a>GraphicsExercise3DView.cpp</h2><p>引入数学函数库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;math.h&gt;</span><br></pre></td></tr></table></figure></p><p>定义π<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#ifndef PI</span><br><span class="line">#define PI 3.14159</span><br><span class="line">#endif // !PI</span><br></pre></td></tr></table></figure></p><p>在构造函数初始化</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">CGraphicsExercise3DView::CGraphicsExercise3DView()</span><br><span class="line">&#123;</span><br><span class="line">// TODO: 在此处添加构造代码</span><br><span class="line"></span><br><span class="line">// 设置斜二测视图倾斜角度（弧度制）</span><br><span class="line">SetSlantRadian(PI / 4);</span><br><span class="line"></span><br><span class="line">// 设置规模比例</span><br><span class="line">SetScale(70);</span><br><span class="line"></span><br><span class="line">// 设置坐标系在x、y方向的位移（不改变规模情况下，即移动像素）</span><br><span class="line">SetTransformOrigin(300, 350);</span><br><span class="line"></span><br><span class="line">// 设置球面半径radius、取样步长stepPhi、stepTheta</span><br><span class="line">SetPlotSphere(2.0, 0.01, 0.1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>设置初始化参数的Set函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// 设置规模</span><br><span class="line">void CGraphicsExercise3DView::SetScale(int scale)</span><br><span class="line">&#123;</span><br><span class="line">this-&gt;scale = scale;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置坐标系原点在x、y方向的位移（不改变规模情况下，即移动像素）</span><br><span class="line">void CGraphicsExercise3DView::SetTransformOrigin(float transformOriginX, float transformOriginY)</span><br><span class="line">&#123;</span><br><span class="line">this-&gt;transformOriginX = transformOriginX;</span><br><span class="line">this-&gt;transformOriginY = transformOriginY;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置球面半径radius、取样步长stepPhi、stepTheta</span><br><span class="line">void CGraphicsExercise3DView::SetPlotSphere(float radius, float stepPhi, float stepTheta)</span><br><span class="line">&#123;</span><br><span class="line">this-&gt;radius = radius;</span><br><span class="line">this-&gt;stepPhi = stepPhi;</span><br><span class="line">this-&gt;stepTheta = stepTheta;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置斜二测视图的倾斜角（单位弧度）</span><br><span class="line">void CGraphicsExercise3DView::SetSlantRadian(float slant)</span><br><span class="line">&#123;</span><br><span class="line">this-&gt;slant = slant;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>坐标及规模变换</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">// 变换规模</span><br><span class="line">float CGraphicsExercise3DView::TransformScale(float num)</span><br><span class="line">&#123;</span><br><span class="line">return num * scale;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 坐标系X轴方向位移</span><br><span class="line">float CGraphicsExercise3DView::TransformOriginX(float x)</span><br><span class="line">&#123;</span><br><span class="line">return x + transformOriginX / scale;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 坐标系y轴方向位移</span><br><span class="line">float CGraphicsExercise3DView::TransformOriginY(float y)</span><br><span class="line">&#123;</span><br><span class="line">return y - transformOriginY / scale;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 变换坐标系X和规模</span><br><span class="line">float CGraphicsExercise3DView::TransformOriginScaleX(float x)</span><br><span class="line">&#123;</span><br><span class="line">return TransformScale(TransformOriginX(x));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 变换坐标系Y和规模</span><br><span class="line">float CGraphicsExercise3DView::TransformOriginScaleY(float y)</span><br><span class="line">&#123;</span><br><span class="line">return -TransformScale(TransformOriginY(y));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>三维坐标转化为二维坐标</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 使用斜二测视图，把三维坐标点转化为二维平面上的点</span><br><span class="line">void CGraphicsExercise3DView::Transform3Dto2D(float &amp;x, float &amp;y, float z)</span><br><span class="line">&#123;</span><br><span class="line">x = x - (z * cos(slant)) / 2;</span><br><span class="line">y = y - (z * sin(slant)) / 2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>绘制坐标轴及函数图形</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">// CGraphicsExercise2View 绘制</span><br><span class="line"></span><br><span class="line">void CGraphicsExercise3DView::OnDraw(CDC* pDC)</span><br><span class="line">&#123;</span><br><span class="line">CGraphicsExercise3DDoc* pDoc = GetDocument();</span><br><span class="line">ASSERT_VALID(pDoc);</span><br><span class="line">if (!pDoc)</span><br><span class="line">return;</span><br><span class="line"></span><br><span class="line">// TODO: 在此处为本机数据添加绘制代码</span><br><span class="line"></span><br><span class="line">float x, y, z;</span><br><span class="line"></span><br><span class="line">// -------------------- 绘制坐标系 -------------------------</span><br><span class="line"></span><br><span class="line">// 坐标x轴</span><br><span class="line">pDC-&gt;MoveTo(TransformOriginScaleX(0), TransformOriginScaleY(0));</span><br><span class="line">pDC-&gt;LineTo(TransformOriginScaleX(radius + 2), TransformOriginScaleY(0));</span><br><span class="line"></span><br><span class="line">// 坐标y轴</span><br><span class="line">pDC-&gt;MoveTo(TransformOriginScaleX(0), TransformOriginScaleY(0));</span><br><span class="line">pDC-&gt;LineTo(TransformOriginScaleX(0), TransformOriginScaleY(radius + 2));</span><br><span class="line"></span><br><span class="line">// 坐标z轴</span><br><span class="line">x = 0, y = 0;</span><br><span class="line">Transform3Dto2D(x, y, radius + 5);</span><br><span class="line">pDC-&gt;MoveTo(TransformOriginScaleX(0), TransformOriginScaleY(0));</span><br><span class="line">pDC-&gt;LineTo(TransformOriginScaleX(x), TransformOriginScaleY(y));</span><br><span class="line"></span><br><span class="line">// 坐标x轴的箭头</span><br><span class="line">pDC-&gt;MoveTo(TransformOriginScaleX(radius + 1.8), TransformOriginScaleY(0.2));</span><br><span class="line">pDC-&gt;LineTo(TransformOriginScaleX(radius + 2), TransformOriginScaleY(0));</span><br><span class="line">pDC-&gt;LineTo(TransformOriginScaleX(radius + 1.8), TransformOriginScaleY(-0.2));</span><br><span class="line"></span><br><span class="line">// 坐标y轴的箭头</span><br><span class="line">pDC-&gt;MoveTo(TransformOriginScaleX(-0.2), TransformOriginScaleY(radius + 1.8));</span><br><span class="line">pDC-&gt;LineTo(TransformOriginScaleX(0), TransformOriginScaleY(radius + 2));</span><br><span class="line">pDC-&gt;LineTo(TransformOriginScaleX(0.2), TransformOriginScaleY(radius + 1.8));</span><br><span class="line"></span><br><span class="line">// 坐标z轴的箭头</span><br><span class="line">x = 0, y = 0.2;</span><br><span class="line">Transform3Dto2D(x, y, radius + 5 - 0.2);</span><br><span class="line">pDC-&gt;MoveTo(TransformOriginScaleX(x), TransformOriginScaleY(y));</span><br><span class="line">x = 0, y = 0;</span><br><span class="line">Transform3Dto2D(x, y, radius + 5);</span><br><span class="line">pDC-&gt;LineTo(TransformOriginScaleX(x), TransformOriginScaleY(y));</span><br><span class="line">x = 0.2, y = 0;</span><br><span class="line">Transform3Dto2D(x, y, radius + 5 - 0.2);</span><br><span class="line">pDC-&gt;LineTo(TransformOriginScaleX(x), TransformOriginScaleY(y));</span><br><span class="line"></span><br><span class="line">// -------------------- 绘制刻度线 -------------------------</span><br><span class="line"></span><br><span class="line">// 绘制x轴刻度线</span><br><span class="line">for (float scaleX = 0.2; scaleX &lt; radius + 1; scaleX += 0.2)</span><br><span class="line">&#123;</span><br><span class="line">pDC-&gt;MoveTo((int)TransformOriginScaleX(scaleX), (int)TransformOriginScaleY(0));</span><br><span class="line">pDC-&gt;LineTo((int)TransformOriginScaleX(scaleX), (int)TransformOriginScaleY(0.1));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 绘制y轴刻度线</span><br><span class="line">for (float scaleY = 0.2; scaleY &lt;= radius + 1; scaleY += 0.2)</span><br><span class="line">&#123;</span><br><span class="line">pDC-&gt;MoveTo((int)TransformOriginScaleX(0), (int)TransformOriginScaleY(scaleY));</span><br><span class="line">pDC-&gt;LineTo((int)TransformOriginScaleX(0.1), (int)TransformOriginScaleY(scaleY));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 绘制z轴刻度线</span><br><span class="line">for (float x = 0, y = 0, scaleZ = 0.2; scaleZ &lt;= radius + 4; scaleZ += 0.2, x = 0, y = 0)</span><br><span class="line">&#123;</span><br><span class="line">Transform3Dto2D(x, y, scaleZ);</span><br><span class="line">pDC-&gt;MoveTo((int)TransformOriginScaleX(x), (int)TransformOriginScaleY(y));</span><br><span class="line">pDC-&gt;LineTo((int)TransformOriginScaleX(x + 0.1), (int)TransformOriginScaleY(y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// -------------------- 绘制文字 -------------------------</span><br><span class="line"></span><br><span class="line">// 绘制x轴的x</span><br><span class="line">pDC-&gt;TextOutW(TransformOriginScaleX(radius + 1.6), TransformOriginScaleY(-0.2), CString(&quot;x&quot;));</span><br><span class="line">// 绘制y轴的y</span><br><span class="line">pDC-&gt;TextOutW(TransformOriginScaleX(-0.2), TransformOriginScaleY(radius + 1.6), CString(&quot;y&quot;));</span><br><span class="line">// 绘制z轴的z</span><br><span class="line">x = 0.2, y = 0;</span><br><span class="line">Transform3Dto2D(x, y, radius + 5 - 0.4);</span><br><span class="line">pDC-&gt;TextOutW(TransformOriginScaleX(x), TransformOriginScaleY(y), CString(&quot;z&quot;));</span><br><span class="line"></span><br><span class="line">CString s;</span><br><span class="line">// 绘制x轴刻度文字</span><br><span class="line">for (float ScaleTextX = 0.4; ScaleTextX &lt; radius + 1; ScaleTextX += 0.4)</span><br><span class="line">&#123;</span><br><span class="line">s.Format(_T(&quot;%.1f&quot;), ScaleTextX);</span><br><span class="line">pDC-&gt;TextOutW(TransformOriginScaleX(ScaleTextX - 0.1), TransformOriginScaleY(-0.1), s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 绘制y轴刻度文字</span><br><span class="line">for (float ScaleTextY = 0.4; ScaleTextY &lt;= radius + 1; ScaleTextY += 0.4)</span><br><span class="line">&#123;</span><br><span class="line">s.Format(_T(&quot;%.1f&quot;), ScaleTextY);</span><br><span class="line">pDC-&gt;TextOutW(TransformOriginScaleX(-0.4), TransformOriginScaleY(ScaleTextY + 0.1), s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 绘制z轴刻度文字</span><br><span class="line">for (float ScaleTextZ = 0.6; ScaleTextZ &lt;= radius + 4; ScaleTextZ += 0.6)</span><br><span class="line">&#123;</span><br><span class="line">s.Format(_T(&quot;%.1f&quot;), ScaleTextZ);</span><br><span class="line">x = 0, y = 0;</span><br><span class="line">Transform3Dto2D(x, y, ScaleTextZ);</span><br><span class="line">pDC-&gt;TextOutW(TransformOriginScaleX(x + 0.15), TransformOriginScaleY(y + 0.12), s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 绘制函数图的Title</span><br><span class="line">x = 0, y = 0;</span><br><span class="line">Transform3Dto2D(x, y, radius + 5);</span><br><span class="line">pDC-&gt;TextOutW(TransformOriginScaleX(x + 3), TransformOriginScaleY(y), CString(&quot;x^2 + y^2 + z^2 = r^2&quot;));</span><br><span class="line"></span><br><span class="line">// -------------------- 绘制函数 -------------------------</span><br><span class="line"></span><br><span class="line">// 球面</span><br><span class="line">float phi, theta;</span><br><span class="line">for (phi = 0; phi &lt; 2 * PI; phi += stepPhi)</span><br><span class="line">&#123;</span><br><span class="line">for (theta = 0; theta &lt; PI; theta += stepTheta)</span><br><span class="line">&#123;</span><br><span class="line">x = radius * sin(phi) * cos(theta);</span><br><span class="line">y = radius * sin(phi) * sin(theta);</span><br><span class="line">z = radius * cos(phi);</span><br><span class="line"></span><br><span class="line">Transform3Dto2D(x, y, z);</span><br><span class="line"></span><br><span class="line">srand(z);</span><br><span class="line">pDC-&gt;SetPixel(TransformOriginScaleX(x), TransformOriginScaleY(y), RGB(rand() % 255, rand() % 255, rand() % 255));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//// 三棱锥（测试用）</span><br><span class="line">//x = 1, y = 0, z = 0;</span><br><span class="line">//Transform3Dto2D(x, y, z);</span><br><span class="line">//pDC-&gt;MoveTo((int)TransformOriginScaleX(x), (int)TransformOriginScaleY(y));</span><br><span class="line"></span><br><span class="line">//x = 0, y = 1, z = 0;</span><br><span class="line">//Transform3Dto2D(x, y, z);</span><br><span class="line">//pDC-&gt;LineTo((int)TransformOriginScaleX(x), (int)TransformOriginScaleY(y));</span><br><span class="line"></span><br><span class="line">//x = 0, y = 0, z = 1;</span><br><span class="line">//Transform3Dto2D(x, y, z);</span><br><span class="line">//pDC-&gt;LineTo((int)TransformOriginScaleX(x), (int)TransformOriginScaleY(y));</span><br><span class="line"></span><br><span class="line">//x = 1, y = 0, z = 0;</span><br><span class="line">//Transform3Dto2D(x, y, z);</span><br><span class="line">//pDC-&gt;LineTo((int)TransformOriginScaleX(x), (int)TransformOriginScaleY(y));</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h2><p><img src="http://ojlsgreog.bkt.clouddn.com/GraphicsExercise3DCapture.png" alt="GraphicsExercise3DCapture"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;系列链接&quot;&gt;&lt;a href=&quot;#系列链接&quot; class=&quot;headerlink&quot; title=&quot;系列链接&quot;&gt;&lt;/a&gt;系列链接&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://blog.huihut.com/2017/10/13/GraphicsExercise2D/&quot;&gt;使用MFC的CDC类绘制二维坐标系及正余弦函数&lt;/a&gt; / &lt;a href=&quot;https://github.com/huihut/GraphicsExercise2D&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;源码&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://blog.huihut.com/2017/10/13/GraphicsExercise3D/&quot;&gt;使用MFC的CDC类绘制三维坐标系及球面函数&lt;/a&gt; / &lt;a href=&quot;https://github.com/huihut/GraphicsExercise3D&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;源码&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概述&quot; class=&quot;headerlink&quot; title=&quot;概述&quot;&gt;&lt;/a&gt;概述&lt;/h2&gt;&lt;p&gt;本文使用MFC的CDC类绘制三维坐标系及球面函数。首先计算推导出三维坐标在二维平面显示的坐标变换方程（使用斜二测视图），使用球面的参数方程，然后定义图形缩放比例规模、坐标轴位移，变换坐标系和规模等，最后绘制坐标轴及球面函数。&lt;/p&gt;
&lt;p&gt;如果对绘制二维坐标系还不太熟悉可以先看上面系列链接的：&lt;a href=&quot;https://blog.huihut.com/2017/10/13/GraphicsExercise2D/&quot;&gt;使用MFC的CDC类绘制二维坐标系及正余弦函数&lt;/a&gt;，本文对二维绘制及绘制函数部分不再赘述。因为二维坐标系的博文已经分模块讲解地比较清楚了，而与三维坐标系的基本思路相同，所以本文大部分直接使用注释讲解。&lt;/p&gt;
    
    </summary>
    
      <category term="CS" scheme="https://blog.huihut.com/categories/CS/"/>
    
    
      <category term="图形学" scheme="https://blog.huihut.com/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/"/>
    
      <category term="MFC" scheme="https://blog.huihut.com/tags/MFC/"/>
    
  </entry>
  
</feed>
